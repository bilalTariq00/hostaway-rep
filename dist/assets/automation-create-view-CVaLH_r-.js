import{D as X,r,j as e,B as s,I as k,T as i,a as x,x as f,e as u,a4 as H}from"./index-DDMGUD-_.js";import{D as Z}from"./content-DAzX26cm.js";import{A as w}from"./arrow-left-DVLbOZnK.js";import{S as ee}from"./save-D0sLAz8V.js";import{C as Y}from"./Card-C1fEEBVz.js";import{T as h}from"./TextField-BZcg-6kp.js";import{I as b}from"./info-_UHBnIlD.js";import{A as S,a as I,b as W}from"./AccordionSummary-C8_g3HoB.js";import{C as A}from"./chevron-down-B-CwXX_-.js";import{F}from"./FormControl-BRgYzLHi.js";import{S as N}from"./Select-DixiLax7.js";import{C as te}from"./Checkbox-DrgNyHeB.js";import"./InputLabel-B_w9HMQG.js";import"./Menu-Bm1ShPnp.js";import"./SwitchBase-s8UEUZOy.js";const P=[{id:305034,name:"La Dimora Del Cavaliere",image:"https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-1.webp",selected:!1},{id:305035,name:"Navigli",image:"https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-2.webp",selected:!1},{id:305225,name:"Polacchi42",image:"https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-3.webp",selected:!0},{id:305421,name:"Superattico - Via Del Corso 43",image:"https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-4.webp",selected:!1},{id:306532,name:"Montecatini Terme",image:"https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-5.webp",selected:!1},{id:308582,name:"Monteverde - Quattroventi",image:"https://pub-c5e31b5cdafb419fb247a8ac2e78df7a.r2.dev/public/assets/images/mock/cover/cover-6.webp",selected:!1}],se=["Thank you for booking","Before you arrive","Welcome message","Before you leave","Leave a review"];function be(){const R=X(),[j,n]=r.useState(""),[V,T]=r.useState(""),[q,B]=r.useState(""),[y,l]=r.useState(""),[_,c]=r.useState(""),[z,D]=r.useState("Reservation"),[p,M]=r.useState([]),[g,v]=r.useState(P),[L,J]=r.useState(""),[C,Q]=r.useState(!1);r.useEffect(()=>{const t=localStorage.getItem("automationToCopy");if(t){const o=JSON.parse(t);n(`${o.title} (Copy)`),T(o.ccEmail1||""),B(o.ccEmail2||""),l(o.subject||""),c(o.defaultMessage||""),D(o.eventTrigger||""),M(o.selectedChannels||[]),v(P.map(a=>{var m;return{...a,selected:((m=o.selectedListings)==null?void 0:m.some(d=>d.id===a.id))||!1}})),localStorage.removeItem("automationToCopy")}},[]);const G=()=>{var m;const t={id:Date.now(),title:j,subject:y,event:z,channels:p.map(d=>({name:d,color:d==="Booking.com"?"#003580":"#FF5A5F",icon:d==="Booking.com"?"ðŸ¨":"ðŸ "})),listing:((m=g.find(d=>d.selected))==null?void 0:m.name)||"Multiple Listings",creationDate:new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),lastEdit:new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),automationId:Math.floor(Math.random()*1e6).toString(),isActive:!0},a=[...JSON.parse(localStorage.getItem("automations")||"[]"),t];localStorage.setItem("automations",JSON.stringify(a)),R.push("/inbox/automations")},E=()=>{R.push("/inbox/automations")},O=t=>{v(o=>o.map(a=>a.id===t?{...a,selected:!a.selected}:a))},$=()=>{const t=g.every(o=>o.selected);v(o=>o.map(a=>({...a,selected:!t})))},K=t=>{M(o=>o.includes(t)?o.filter(a=>a!==t):[...o,t])},U=g.filter(t=>{const o=t.name.toLowerCase().includes(L.toLowerCase());return C?t.selected&&o:o});return e.jsxs(Z,{maxWidth:"xl",children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(k,{sx:{p:1},onClick:E,children:e.jsx(w,{size:20})}),e.jsx(i,{variant:"h4",sx:{fontWeight:600},children:"Automation"})]}),e.jsxs(s,{sx:{display:"flex",gap:2},children:[e.jsx(x,{variant:"outlined",onClick:E,sx:{borderColor:"#e0e0e0",color:"#666",px:3,py:1.5,borderRadius:2},children:"Cancel"}),e.jsx(x,{variant:"contained",startIcon:e.jsx(ee,{size:20}),onClick:G,disabled:!j.trim()||!y.trim()||!_.trim(),sx:{bgcolor:"#23c6c8","&:hover":{bgcolor:"#1fb3b5"},"&:disabled":{bgcolor:"grey.300"},px:3,py:1.5,borderRadius:2},children:"Save"})]})]}),e.jsxs(s,{sx:{display:"flex",gap:4},children:[e.jsx(s,{sx:{flex:2,minWidth:0},children:e.jsxs(Y,{sx:{p:3,mb:3},children:[e.jsx(i,{variant:"h6",sx:{mb:3,fontWeight:600},children:"Automation Details"}),e.jsxs(s,{sx:{mb:3},children:[e.jsx(i,{variant:"body2",sx:{mb:1,fontWeight:500},children:"Automation name *"}),e.jsx(h,{fullWidth:!0,value:j,onChange:t=>n(t.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]}),e.jsxs(s,{sx:{display:"flex",gap:2,mb:3},children:[e.jsxs(s,{sx:{flex:1},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:500},children:"CC email 1"}),e.jsx(f,{title:"Add CC recipients",children:e.jsx(b,{size:16,color:"#666"})})]}),e.jsx(h,{fullWidth:!0,placeholder:"CC email",value:V,onChange:t=>T(t.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]}),e.jsxs(s,{sx:{flex:1},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:500},children:"CC email 2"}),e.jsx(f,{title:"Add CC recipients",children:e.jsx(b,{size:16,color:"#666"})})]}),e.jsx(h,{fullWidth:!0,placeholder:"CC email",value:q,onChange:t=>B(t.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]})]}),e.jsxs(s,{sx:{mb:3},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:500},children:"Subject *"}),e.jsx(x,{size:"small",variant:"outlined",sx:{borderColor:"#e0e0e0",color:"#666",minWidth:"auto",px:1,py:.5},children:"{}"})]}),e.jsx(h,{fullWidth:!0,value:y,onChange:t=>l(t.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]}),e.jsxs(s,{sx:{mb:3},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:500},children:"Default message *"}),e.jsx(f,{title:"Message content with variables",children:e.jsx(b,{size:16,color:"#666"})}),e.jsx(x,{size:"small",variant:"outlined",sx:{borderColor:"#e0e0e0",color:"#666",minWidth:"auto",px:1,py:.5},children:"{}"})]}),e.jsx(h,{fullWidth:!0,multiline:!0,rows:12,value:_,onChange:t=>c(t.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]}),e.jsxs(S,{sx:{mb:3},children:[e.jsx(I,{expandIcon:e.jsx(A,{size:16}),children:e.jsx(i,{variant:"body2",sx:{fontWeight:600},children:"Languages"})}),e.jsx(W,{children:e.jsxs(s,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:500},children:"Event trigger *"}),e.jsx(F,{size:"small",sx:{minWidth:100},children:e.jsxs(N,{value:"At",displayEmpty:!0,sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"#e0e0e0"}},children:[e.jsx(u,{value:"At",children:"At"}),e.jsx(u,{value:"Before",children:"Before"}),e.jsx(u,{value:"After",children:"After"})]})}),e.jsx(F,{size:"small",sx:{minWidth:120},children:e.jsxs(N,{value:z,onChange:t=>D(t.target.value),displayEmpty:!0,sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"#e0e0e0"}},children:[e.jsx(u,{value:"Reservation",children:"Reservation"}),e.jsx(u,{value:"Check-in",children:"Check-in"}),e.jsx(u,{value:"Check-out",children:"Check-out"})]})})]})})]}),e.jsxs(S,{sx:{mb:3},children:[e.jsx(I,{expandIcon:e.jsx(A,{size:16}),children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:600},children:"Additional conditions"}),e.jsx(f,{title:"Set additional conditions for this automation",children:e.jsx(b,{size:16,color:"#23c6c8"})})]})}),e.jsx(W,{children:e.jsxs(s,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(s,{children:[e.jsx(i,{variant:"body2",sx:{fontWeight:600,mb:2},children:"Channels"}),e.jsx(s,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:["Booking.com","Airbnb","VRBO","Direct"].map(t=>e.jsxs(s,{onClick:()=>K(t),sx:{display:"flex",alignItems:"center",gap:.5,px:2,py:1,borderRadius:2,border:"1px solid #e0e0e0",cursor:"pointer",bgcolor:p.includes(t)?"#f5f5f5":"white","&:hover":{bgcolor:p.includes(t)?"#eeeeee":"#f9f9f9"}},children:[e.jsx(s,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:t==="Booking.com"?"#003580":t==="Airbnb"?"#FF5A5F":t==="VRBO"?"#00A699":"#666"}}),e.jsx(i,{variant:"body2",sx:{fontSize:"0.875rem"},children:t}),p.includes(t)&&e.jsx(k,{size:"small",sx:{p:.5,ml:.5},children:e.jsx(w,{size:12})})]},t))})]}),e.jsxs(s,{children:[e.jsx(i,{variant:"body2",sx:{fontWeight:600,mb:2},children:"Listings"}),e.jsxs(s,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(h,{placeholder:"Type to search listings",value:L,onChange:t=>J(t.target.value),sx:{flex:1,"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsxs(x,{variant:"text",onClick:()=>Q(!C),sx:{color:C?"#23c6c8":"#666",textTransform:"none"},children:["Show ",g.filter(t=>t.selected).length," selected only"]}),e.jsx(x,{variant:"contained",onClick:$,sx:{bgcolor:"#23c6c8","&:hover":{bgcolor:"#1fb3b5"},borderRadius:2},children:"Select all"})]}),e.jsx(s,{sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:2,maxHeight:300,overflowY:"auto"},children:U.map(t=>e.jsxs(H,{sx:{p:2,display:"flex",alignItems:"center",gap:2,cursor:"pointer",border:"1px solid #e0e0e0",borderRadius:2,bgcolor:t.selected?"#e3f2fd":"white","&:hover":{borderColor:"#23c6c8",boxShadow:"0 2px 8px rgba(35, 198, 200, 0.1)"}},onClick:()=>O(t.id),children:[e.jsx(s,{sx:{width:60,height:40,borderRadius:1,backgroundImage:`url('${t.image}')`,backgroundSize:"cover",backgroundPosition:"center",flexShrink:0}}),e.jsxs(s,{sx:{flex:1,minWidth:0},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:500,mb:.5},children:t.name}),e.jsx(i,{variant:"caption",color:"text.secondary",children:t.id})]}),e.jsx(te,{checked:t.selected,onChange:()=>O(t.id),sx:{flexShrink:0}})]},t.id))})]})]})})]})]})}),e.jsx(s,{sx:{flex:1,minWidth:350,maxWidth:400},children:e.jsxs(Y,{sx:{p:3,position:"sticky",top:20,height:"fit-content"},children:[e.jsx(i,{variant:"body2",sx:{mb:2,color:"#666"},children:"You can choose existing template as an example."}),e.jsxs(S,{defaultExpanded:!0,children:[e.jsx(I,{expandIcon:e.jsx(A,{size:16}),children:e.jsx(i,{variant:"body2",sx:{fontWeight:600},children:"Choose one of example templates"})}),e.jsx(W,{children:e.jsx(s,{sx:{display:"flex",flexDirection:"column",gap:1},children:se.map((t,o)=>e.jsx(x,{variant:"outlined",onClick:()=>{t==="Thank you for booking"?(n("Reservation Confirmation"),l("Thank you for your reservation! ðŸŽ‰"),c(`Hello {{guest_first_name}},

Thank you for choosing to stay at our {{listing_name}}! We're excited to host you and will do our best to make your stay unforgettable.

Best regards,
Your Host`)):t==="Before you arrive"?(n("Pre-arrival Instructions"),l("Important information before your arrival"),c(`Hello {{guest_first_name}},

Your stay at {{listing_name}} is approaching! Here are some important details:

- Check-in time: {{checkin_time}}
- Check-in location: {{checkin_location}}
- Key collection: {{key_instructions}}

If you have any questions, please don't hesitate to contact us.

Best regards,
Your Host`)):t==="Welcome message"?(n("Welcome Message"),l("Welcome to your stay!"),c(`Hello {{guest_first_name}},

Welcome to {{listing_name}}! We hope you have a wonderful stay.

Here are some quick tips:
- WiFi password: {{wifi_password}}
- Emergency contact: {{emergency_contact}}
- House rules: Please be respectful of the property and neighbors

Enjoy your stay!

Best regards,
Your Host`)):t==="Before you leave"?(n("Check-out Reminder"),l("Check-out tomorrow"),c(`Hello {{guest_first_name}},

Your check-out is tomorrow at {{checkout_time}}. Please remember to:

- Leave the keys at {{key_return_location}}
- Take all your belongings
- Leave the property in good condition

Thank you for staying with us!

Best regards,
Your Host`)):t==="Leave a review"&&(n("Review Request"),l("How was your stay?"),c(`Hello {{guest_first_name}},

Thank you for staying at {{listing_name}}! We hope you had a wonderful time.

We would greatly appreciate it if you could take a moment to leave a review about your experience. Your feedback helps us improve and helps future guests make informed decisions.

You can leave a review here: {{review_url}}

Thank you again for choosing to stay with us!

Best regards,
Your Host`))},sx:{justifyContent:"flex-start",textAlign:"left",borderColor:"#e0e0e0",color:"#666",mb:1,"&:hover":{borderColor:"#23c6c8",color:"#23c6c8"}},children:t},o))})})]})]})})]}),e.jsxs(s,{sx:{position:"fixed",bottom:20,right:20,zIndex:1e3},children:[e.jsxs(H,{sx:{p:2,mb:1,borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:1},children:[e.jsx(i,{variant:"body2",children:"Hi. Need any help?"}),e.jsx(k,{size:"small",children:e.jsx(w,{size:16})})]}),e.jsxs(s,{sx:{width:50,height:50,bgcolor:"#ff6b35",borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",cursor:"pointer",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[e.jsx(i,{variant:"h6",sx:{color:"white",fontWeight:600},children:"3"}),e.jsx(s,{sx:{position:"absolute",top:-5,right:-5,width:20,height:20,bgcolor:"#ff0000",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(i,{variant:"caption",sx:{color:"white",fontSize:"10px"},children:"3"})})]})]})]})}export{be as AutomationCreateView};
