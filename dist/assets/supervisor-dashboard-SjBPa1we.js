import{af as Y,H as q,bl as V,bn as K,b0 as X,r as v,j as e,B as a,T as r,A as h,C,a1 as S,F as M,O as u,I as U}from"./index-DDMGUD-_.js";import{D as Z}from"./content-DAzX26cm.js";import{G as t}from"./Grid-CFM_c-Vf.js";import{C as c}from"./Card-C1fEEBVz.js";import{C as d}from"./CardContent-Bmb6KKQR.js";import{S as x}from"./Stack-B9BpzM62.js";import{U as _}from"./users-CMxhWVqr.js";import{B as ee}from"./building-2-ARET-4eE.js";import{M as B}from"./map-pin-D7szlGeT.js";import{T as D}from"./trending-up-CCTv0Uik.js";import{C as f}from"./CardHeader-BtOJpbTN.js";import{C as se}from"./clock-DKhyGhJk.js";import{S as re}from"./star-toYtlyOf.js";import{T as ae}from"./target-C1kLD6ub.js";import{T as ie}from"./TextField-BZcg-6kp.js";import"./Select-DixiLax7.js";import"./Menu-Bm1ShPnp.js";import"./InputLabel-B_w9HMQG.js";import"./FormControl-BRgYzLHi.js";function Ce(){const n=Y(),{user:o}=q(),{getAllWorkersPerformance:Q}=V(),{addRating:R}=K(),{sendPerformanceWarning:E}=X(),[I,$]=v.useState({}),[T,O]=v.useState({}),[b,F]=v.useState([]),[z,L]=v.useState([]),[A,G]=v.useState([]),W=(s,m,i)=>{$(g=>({...g,[s]:i})),o&&R({workerId:s,workerName:m,ratedBy:o.id,ratedByName:o.name,rating:i,feedback:T[s]})},H=(s,m,i)=>{O(g=>({...g,[s]:m})),o&&I[s]&&R({workerId:s,workerName:i,ratedBy:o.id,ratedByName:o.name,rating:I[s],feedback:m})};v.useEffect(()=>{if(o!=null&&o.assignedUsers){const m=JSON.parse(localStorage.getItem("createdUsers")||"[]").filter(j=>{var p;return(p=o.assignedUsers)==null?void 0:p.includes(j.id)});F(m);const i=JSON.parse(localStorage.getItem("clients")||"[]"),g=[{id:"305034",name:"La Dimora Del Cavaliere",location:"Anguillara Sabazia, Italy",clientId:"client1"},{id:"305035",name:"Navigli",location:"Milano, Italy",clientId:"client1"},{id:"305225",name:"Polacchi42",location:"Roma, Italy",clientId:"client2"},{id:"305421",name:"Superattico - Via Del Corso 43",location:"Roma, Italy",clientId:"client2"},{id:"306532",name:"Montecatini Terme",location:"Montecatini Terme, Italy",clientId:"client3"},{id:"306533",name:"Tuscany Villa",location:"Florence, Italy",clientId:"client3"},{id:"306534",name:"Coastal Retreat",location:"Amalfi, Italy",clientId:"client4"}],y=new Set;m.forEach(j=>{var p;(p=j.assignedClients)==null||p.forEach(k=>y.add(k))});const w=i.filter(j=>y.has(j.id));L(w);const l=new Set;m.forEach(j=>{var p;(p=j.assignedProperties)==null||p.forEach(k=>l.add(k))});const J=g.filter(j=>l.has(j.id));G(J)}},[o]);const N=s=>{switch(s){case"active":return"success";case"inactive":return"warning";case"suspended":return"error";default:return"default"}},P=s=>{switch(s){case"active":return"Active";case"inactive":return"Inactive";case"suspended":return"Suspended";default:return"Active"}};return e.jsxs(Z,{maxWidth:"xl",children:[e.jsxs(a,{sx:{mb:3},children:[e.jsx(r,{variant:"h4",gutterBottom:!0,children:"Supervisor Dashboard"}),e.jsxs(r,{variant:"body2",color:"text.secondary",children:["Welcome back, ",o==null?void 0:o.name,"! Here's an overview of your assigned resources and team performance."]})]}),e.jsxs(t,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(t,{size:{xs:12,sm:6,md:3},children:e.jsx(c,{children:e.jsx(d,{children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{bgcolor:"primary.main"},children:e.jsx(_,{size:24})}),e.jsxs(a,{children:[e.jsx(r,{variant:"h4",children:b.length}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Assigned Associates"})]})]})})})}),e.jsx(t,{size:{xs:12,sm:6,md:3},children:e.jsx(c,{children:e.jsx(d,{children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{bgcolor:"secondary.main"},children:e.jsx(ee,{size:24})}),e.jsxs(a,{children:[e.jsx(r,{variant:"h4",children:z.length}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Managed Clients"})]})]})})})}),e.jsx(t,{size:{xs:12,sm:6,md:3},children:e.jsx(c,{children:e.jsx(d,{children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{bgcolor:"info.main"},children:e.jsx(B,{size:24})}),e.jsxs(a,{children:[e.jsx(r,{variant:"h4",children:A.length}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Total Properties"})]})]})})})}),e.jsx(t,{size:{xs:12,sm:6,md:3},children:e.jsx(c,{children:e.jsx(d,{children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{bgcolor:"success.main"},children:e.jsx(D,{size:24})}),e.jsxs(a,{children:[e.jsx(r,{variant:"h4",children:"94%"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Response Rate"})]})]})})})})]}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{size:{xs:12,md:6},children:e.jsxs(c,{children:[e.jsx(f,{title:"Assigned Associates"}),e.jsx(d,{children:b.length===0?e.jsx(r,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No associates assigned yet"}):e.jsx(x,{spacing:2,children:b.map(s=>e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:s.avatar?"transparent":"primary.main",backgroundImage:s.avatar?`url(${s.avatar})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:!s.avatar&&s.name.charAt(0).toUpperCase()}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(r,{variant:"subtitle2",children:s.name}),e.jsx(r,{variant:"caption",color:"text.secondary",children:s.email})]}),e.jsx(C,{label:P(s.status),color:N(s.status),size:"small"})]},s.id))})})]})}),e.jsx(t,{size:{xs:12,md:6},children:e.jsxs(c,{children:[e.jsx(f,{title:"Managed Clients"}),e.jsx(d,{children:z.length===0?e.jsx(r,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No clients managed yet"}):e.jsx(x,{spacing:2,children:z.map(s=>e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"secondary.main"},children:s.name.charAt(0).toUpperCase()}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(r,{variant:"subtitle2",children:s.name}),e.jsx(r,{variant:"caption",color:"text.secondary",children:s.email})]}),e.jsx(C,{label:P(s.status),color:N(s.status),size:"small"})]},s.id))})})]})}),e.jsx(t,{size:{xs:12},children:e.jsxs(c,{children:[e.jsx(f,{title:"Properties Overview"}),e.jsx(d,{children:A.length===0?e.jsx(r,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No properties assigned yet"}):e.jsx(t,{container:!0,spacing:2,children:A.map(s=>e.jsx(t,{size:{xs:12,sm:6,md:4},children:e.jsx(c,{variant:"outlined",children:e.jsxs(d,{children:[e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,sx:{mb:1},children:[e.jsx(B,{size:16,color:"#666"}),e.jsx(r,{variant:"subtitle2",sx:{flex:1},children:s.name})]}),e.jsx(r,{variant:"caption",color:"text.secondary",children:s.location}),e.jsxs(r,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["ID: ",s.id]})]})})},s.id))})})]})}),e.jsx(t,{size:{xs:12,md:6},children:e.jsxs(c,{children:[e.jsx(f,{title:"Team Performance"}),e.jsx(d,{children:e.jsxs(x,{spacing:3,children:[e.jsxs(a,{children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(r,{variant:"body2",children:"Response Rate"}),e.jsx(r,{variant:"body2",sx:{fontWeight:600},children:"94%"})]}),e.jsx(S,{variant:"determinate",value:94,sx:{height:8,borderRadius:4}})]}),e.jsxs(a,{children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(r,{variant:"body2",children:"Task Completion"}),e.jsx(r,{variant:"body2",sx:{fontWeight:600},children:"87%"})]}),e.jsx(S,{variant:"determinate",value:87,sx:{height:8,borderRadius:4}})]}),e.jsxs(a,{children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(r,{variant:"body2",children:"Client Satisfaction"}),e.jsx(r,{variant:"body2",sx:{fontWeight:600},children:"92%"})]}),e.jsx(S,{variant:"determinate",value:92,sx:{height:8,borderRadius:4}})]})]})})]})}),e.jsx(t,{size:{xs:12,md:6},children:e.jsxs(c,{children:[e.jsx(f,{title:"Recent Activity"}),e.jsx(d,{children:e.jsxs(x,{spacing:2,children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"success.main",width:32,height:32},children:e.jsx(se,{size:16})}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(r,{variant:"body2",children:"Task completed by John Doe"}),e.jsx(r,{variant:"caption",color:"text.secondary",children:"2 hours ago"})]})]}),e.jsx(M,{}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"info.main",width:32,height:32},children:e.jsx(re,{size:16})}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(r,{variant:"body2",children:"New client assigned"}),e.jsx(r,{variant:"caption",color:"text.secondary",children:"4 hours ago"})]})]}),e.jsx(M,{}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"warning.main",width:32,height:32},children:e.jsx(D,{size:16})}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(r,{variant:"body2",children:"Performance report generated"}),e.jsx(r,{variant:"caption",color:"text.secondary",children:"1 day ago"})]})]})]})})]})}),e.jsx(t,{size:{xs:12},children:e.jsxs(c,{sx:{borderRadius:2,overflow:"hidden"},children:[e.jsx(f,{title:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ae,{size:20,color:n.palette.primary.main}),e.jsx(r,{variant:"h6",sx:{fontWeight:600},children:"Performance Overview & Rating"})]}),subheader:"Rate your team members and provide feedback"}),e.jsx(d,{sx:{p:3},children:b.length===0?e.jsx(r,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:4},children:"No team members assigned yet. Contact an administrator to assign associates to your team."}):e.jsx(t,{container:!0,spacing:3,children:b.map(s=>{const i=Q().find(l=>l.workerName===s.name);if(!i)return e.jsx(t,{size:{xs:12,md:6},children:e.jsx(c,{sx:{border:`1px solid ${u(n.palette.grey[500],.2)}`,bgcolor:"background.paper"},children:e.jsxs(d,{sx:{p:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{width:48,height:48,bgcolor:n.palette.primary.main,fontWeight:600},children:s.name.charAt(0)}),e.jsxs(a,{children:[e.jsx(r,{variant:"subtitle1",sx:{fontWeight:600},children:s.name}),e.jsx(r,{variant:"caption",color:"text.secondary",children:s.email})]})]}),e.jsx(C,{label:"No Data Yet",size:"small",color:"default",sx:{fontWeight:600}})]}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No performance data available"}),e.jsxs(a,{sx:{mt:2,pt:2,borderTop:`1px solid ${u(n.palette.grey[500],.2)}`},children:[e.jsx(r,{variant:"caption",sx:{fontWeight:600,mb:1,display:"block"},children:"Your Rating"}),e.jsx(a,{sx:{display:"flex",gap:1},children:[1,2,3,4,5].map(l=>e.jsx(U,{size:"small",onClick:()=>W(s.name,s.name,l),sx:{color:I[s.name]>=l?n.palette.warning.main:n.palette.grey[400],"&:hover":{color:n.palette.warning.main}},children:"★"},l))})]})]})})},s.id);const g=i.averageQualityScore<70,y=i.averageQualityScore>=70&&i.averageQualityScore<80,w=i.averageQualityScore>=80;return e.jsx(t,{size:{xs:12,md:6},children:e.jsx(c,{sx:{border:g?`2px solid ${n.palette.error.main}`:`1px solid ${u(n.palette.grey[500],.2)}`,bgcolor:g?u(n.palette.error.main,.05):"background.paper"},children:e.jsxs(d,{sx:{p:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{width:48,height:48,bgcolor:n.palette.primary.main,fontWeight:600},children:s.name.charAt(0)}),e.jsxs(a,{children:[e.jsx(r,{variant:"subtitle1",sx:{fontWeight:600},children:s.name}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:[i.totalMessages," messages • Avg: ",Math.round(i.averageQualityScore),"%"]})]})]}),e.jsx(C,{label:w?"Excellent":y?"Good":"Needs Improvement",size:"small",color:w?"success":y?"warning":"error",sx:{fontWeight:600}})]}),e.jsxs(a,{sx:{mb:2},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(r,{variant:"caption",color:"text.secondary",children:"Quality Score"}),e.jsxs(r,{variant:"caption",sx:{fontWeight:600},children:[Math.round(i.averageQualityScore),"%"]})]}),e.jsx(S,{variant:"determinate",value:i.averageQualityScore,sx:{height:8,borderRadius:2,bgcolor:u(n.palette.grey[300],.3),"& .MuiLinearProgress-bar":{bgcolor:w?n.palette.success.main:y?n.palette.warning.main:n.palette.error.main}}})]}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsxs(r,{variant:"caption",color:"text.secondary",children:["Response Time: ",Math.round(i.averageResponseTime/(1e3*60)),"m"]}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:["Messages: ",i.totalMessages]})]}),e.jsxs(a,{sx:{mt:2,pt:2,borderTop:`1px solid ${u(n.palette.grey[500],.2)}`},children:[e.jsx(r,{variant:"caption",sx:{fontWeight:600,mb:1,display:"block"},children:"Your Rating"}),e.jsx(a,{sx:{display:"flex",gap:1},children:[1,2,3,4,5].map(l=>e.jsx(U,{size:"small",onClick:()=>W(i.workerId,i.workerName,l),sx:{color:I[i.workerId]>=l?n.palette.warning.main:n.palette.grey[400],"&:hover":{color:n.palette.warning.main}},children:"★"},l))})]}),g&&e.jsxs(a,{sx:{mt:2,pt:2,borderTop:`1px solid ${u(n.palette.error.main,.3)}`},children:[e.jsx(r,{variant:"caption",sx:{fontWeight:600,mb:1,display:"block",color:"error.main"},children:"Improvement Notes (Required)"}),e.jsx(a,{sx:{width:"100%"},children:e.jsx(ie,{fullWidth:!0,multiline:!0,rows:2,placeholder:"Add notes for improvement...",size:"small",value:T[i.workerId]||"",onChange:l=>{H(i.workerId,l.target.value,i.workerName),l.target.value&&o&&E(i.workerId,o.name,i.averageQualityScore,l.target.value)},sx:{"& .MuiOutlinedInput-root":{fontSize:"0.875rem"}}})})]})]})})},s.id)})})})]})})]})]})}export{Ce as SupervisorDashboardPage};
