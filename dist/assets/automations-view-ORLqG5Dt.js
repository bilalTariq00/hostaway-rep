import{D as le,r as c,j as e,B as a,T as r,a as h,a4 as P,g as S,C as z,I as m,a5 as B,V as oe,e as o}from"./index-DlK49mD9.js";import{D as ce}from"./content-BncdO-AK.js";import{T as de,a as f}from"./Tabs-CawWx8bN.js";import{F as xe}from"./funnel-CgbT2BEe.js";import{T as u}from"./TextField-DGQVylbQ.js";import{S as pe}from"./search-C7TcvOao.js";import{T as he}from"./TableContainer-1FovwQIv.js";import{T as me,a as ue,b as q,c as i,d as ge}from"./TableHead-BbeVJGli.js";import{S as je}from"./Switch-Bj_iObyt.js";import{P as ve}from"./play-DST-Qy0A.js";import{C as ye}from"./copy-DLzUszwU.js";import{P as fe}from"./pencil-Cv1S77MX.js";import{P as be}from"./Pagination-BTzUsZhy.js";import{I as b}from"./info-LH2MLhPO.js";import{F as w}from"./FormControl-DsPW8NaL.js";import{I as N}from"./InputLabel-vBrrCZYs.js";import{S as k}from"./Select-hkki-_gR.js";import{R as Ce,a as U}from"./RadioGroup-lCNJ-Pa9.js";import{F as $}from"./FormControlLabel-DYCM3_AA.js";import{D as Ae,a as Te,b as De,c as Ie}from"./DialogContent-BrwwiAlS.js";import"./KeyboardArrowRight-B0juUeOl.js";import"./SwitchBase-D6K1hBX3.js";import"./LastPage-lp5Gj61X.js";import"./Menu-Cd2TK2zY.js";const Ee=[{id:1,name:"Auto Cleaning Fee",description:"Automatically add cleaning fee for bookings over 3 nights",trigger:"Booking Created",action:"Add Expense",status:"Active",lastRun:"2024-01-15 10:30"},{id:2,name:"Utility Bill Processing",description:"Process monthly utility bills and create expenses",trigger:"Monthly",action:"Create Expense",status:"Active",lastRun:"2024-01-01 00:00"}];function es(){const C=le(),[G,H]=c.useState(3),[L,V]=c.useState(1),[A]=c.useState(25),[T,X]=c.useState(""),[J,g]=c.useState(!1),[Pe,Se]=c.useState(null),[W,j]=c.useState(Ee),[l,v]=c.useState(null),[K,D]=c.useState(!1),[y,I]=c.useState(null),[n,p]=c.useState({type:"Expense",name:"",description:"",categories:"",amount:0,repeatEvery:1,repeatPeriod:"month",repeatOn:31,expenseAppliesTo:"Listings",listings:""}),Q=(s,t)=>{H(t),t===0&&C.push("/expenses-extras/expenses"),t===1&&C.push("/expenses-extras/extras"),t===2&&C.push("/expenses-extras/categories")},d=(s,t)=>{p(x=>({...x,[s]:t}))},Y=s=>{p(t=>({...t,amount:Math.max(0,t.amount+s)}))},Z=()=>{if(n.name.trim()){const s={id:Math.max(...W.map(t=>t.id))+1,name:n.name,description:n.description,trigger:`${n.repeatEvery} ${n.repeatPeriod}`,action:n.type,status:"Active",lastRun:new Date().toLocaleString()};l?l.isDuplicating?j(t=>[...t,s]):j(t=>t.map(x=>x.id===l.id?{...s,id:l.id}:x)):j(t=>[...t,s]),g(!1),v(null),p({type:"Expense",name:"",description:"",categories:"",amount:0,repeatEvery:1,repeatPeriod:"month",repeatOn:31,expenseAppliesTo:"Listings",listings:""})}},_=s=>{v(s),p({type:s.action,name:s.name,description:s.description,categories:"",amount:0,repeatEvery:1,repeatPeriod:"month",repeatOn:31,expenseAppliesTo:"Listings",listings:""}),g(!0)},ee=s=>{v({...s,isDuplicating:!0}),p({type:s.action,name:`${s.name} (Copy)`,description:s.description,categories:"",amount:0,repeatEvery:1,repeatPeriod:"month",repeatOn:31,expenseAppliesTo:"Listings",listings:""}),g(!0)},se=()=>{v(null),p({type:"Expense",name:"",description:"",categories:"",amount:0,repeatEvery:1,repeatPeriod:"month",repeatOn:31,expenseAppliesTo:"Listings",listings:""}),g(!0)},E=()=>{g(!1),v(null),p({type:"Expense",name:"",description:"",categories:"",amount:0,repeatEvery:1,repeatPeriod:"month",repeatOn:31,expenseAppliesTo:"Listings",listings:""})},te=s=>{I(s),D(!0)},ne=()=>{y&&j(s=>s.filter(t=>t.id!==y.id)),D(!1),I(null)},O=()=>{D(!1),I(null)},M=s=>{j(t=>t.map(x=>x.id===s?{...x,status:x.status==="Active"?"Inactive":"Active"}:x))},R=W.filter(s=>s.name.toLowerCase().includes(T.toLowerCase())||s.description.toLowerCase().includes(T.toLowerCase())),ie=Math.ceil(R.length/A),F=(L-1)*A,ae=F+A,re=R.slice(F,ae);return e.jsxs(ce,{maxWidth:"xl",children:[e.jsxs(a,{sx:{mb:3},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(r,{variant:"h4",sx:{fontWeight:600},children:"Expenses and Extras"}),e.jsx(h,{variant:"contained",onClick:se,children:"Add Automation"})]}),e.jsxs(de,{value:G,onChange:Q,sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{textTransform:"none",fontWeight:500},"& .Mui-selected":{color:"primary.main",fontWeight:600},"& .MuiTabs-indicator":{bgcolor:"primary.main"}},children:[e.jsx(f,{label:"Expenses"}),e.jsx(f,{label:"Extras"}),e.jsx(f,{label:"Categories"}),e.jsx(f,{label:"Automations"})]})]}),e.jsx(P,{sx:{p:2,mb:3},children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(h,{variant:"outlined",startIcon:e.jsx(xe,{size:16}),children:"Filter"}),e.jsx(u,{size:"small",placeholder:"Search by name...",value:T,onChange:s=>X(s.target.value),InputProps:{startAdornment:e.jsx(S,{position:"start",children:e.jsx(pe,{size:16,color:"#666"})})},sx:{minWidth:250}})]})}),e.jsx(P,{sx:{mb:3},children:e.jsx(he,{children:e.jsxs(me,{children:[e.jsx(ue,{children:e.jsxs(q,{children:[e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Description"}),e.jsx(i,{children:"Trigger"}),e.jsx(i,{children:"Action"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Last Run"}),e.jsx(i,{align:"center",children:"Actions"})]})}),e.jsx(ge,{children:re.map(s=>e.jsxs(q,{children:[e.jsx(i,{children:e.jsx(r,{variant:"body2",sx:{fontWeight:500},children:s.name})}),e.jsx(i,{children:e.jsx(r,{variant:"body2",color:"text.secondary",children:s.description})}),e.jsx(i,{children:e.jsx(z,{label:s.trigger,size:"small",color:"info"})}),e.jsx(i,{children:e.jsx(z,{label:s.action,size:"small",color:"primary"})}),e.jsx(i,{children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(je,{checked:s.status==="Active",onChange:()=>M(s.id),size:"small"}),e.jsx(z,{label:s.status,size:"small",color:s.status==="Active"?"success":"default"})]})}),e.jsx(i,{children:e.jsx(r,{variant:"body2",color:"text.secondary",children:s.lastRun})}),e.jsx(i,{align:"center",children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(m,{size:"small",onClick:()=>M(s.id),sx:{"&:hover":{bgcolor:"success.lighter"}},children:e.jsx(ve,{size:16})}),e.jsx(m,{size:"small",onClick:()=>ee(s),sx:{"&:hover":{bgcolor:"primary.lighter"}},children:e.jsx(ye,{size:16})}),e.jsx(m,{size:"small",onClick:()=>_(s),sx:{"&:hover":{bgcolor:"primary.lighter"}},children:e.jsx(fe,{size:16})}),e.jsx(m,{size:"small",onClick:()=>te(s),sx:{"&:hover":{bgcolor:"error.lighter"}},children:e.jsx(B,{size:16,color:"#ef4444"})})]})})]},s.id))})]})})}),e.jsx(P,{sx:{p:2},children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(r,{variant:"body2",color:"text.secondary",children:"Show 25 per page"}),e.jsx(be,{count:ie,page:L,onChange:(s,t)=>V(t),color:"primary"})]})}),e.jsxs(oe,{anchor:"right",open:J,onClose:E,sx:{"& .MuiDrawer-paper":{width:500,p:3}},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600},children:l!=null&&l.isDuplicating?"Duplicate automation":l?"Edit automation":"Add new automation"}),e.jsx(m,{onClick:E,children:e.jsx(B,{size:20})})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(u,{fullWidth:!0,label:"Name *",placeholder:"Enter automation name...",value:n.name,onChange:s=>d("name",s.target.value),required:!0,InputProps:{endAdornment:e.jsx(S,{position:"end",children:e.jsx(b,{size:16,color:"#666"})})}}),e.jsx(u,{fullWidth:!0,label:"Description",placeholder:"Enter automation description...",multiline:!0,rows:3,value:n.description,onChange:s=>d("description",s.target.value),InputProps:{endAdornment:e.jsx(S,{position:"end",children:e.jsx(b,{size:16,color:"#666"})})}}),e.jsxs(w,{fullWidth:!0,children:[e.jsx(N,{children:"Categories"}),e.jsxs(k,{label:"Categories",value:n.categories,onChange:s=>d("categories",s.target.value),children:[e.jsx(o,{value:"maintenance",children:"Maintenance"}),e.jsx(o,{value:"utilities",children:"Utilities"}),e.jsx(o,{value:"marketing",children:"Marketing"}),e.jsx(o,{value:"transportation",children:"Transportation"})]})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(r,{variant:"body2",sx:{minWidth:60},children:"Amount *"}),e.jsx(m,{size:"small",onClick:()=>Y(-1),sx:{border:"1px solid",borderColor:"divider"},children:e.jsx(r,{variant:"body2",children:"-"})}),e.jsx(u,{size:"small",type:"number",value:n.amount,onChange:s=>d("amount",parseFloat(s.target.value)||0),sx:{flex:1}})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(r,{variant:"body2",sx:{minWidth:100},children:"Repeat every *"}),e.jsx(u,{size:"small",type:"number",value:n.repeatEvery,onChange:s=>d("repeatEvery",parseInt(s.target.value)||1),sx:{width:80}}),e.jsx(w,{sx:{minWidth:120},children:e.jsxs(k,{value:n.repeatPeriod,onChange:s=>d("repeatPeriod",s.target.value),size:"small",children:[e.jsx(o,{value:"day",children:"day"}),e.jsx(o,{value:"week",children:"week"}),e.jsx(o,{value:"month",children:"month"}),e.jsx(o,{value:"year",children:"year"})]})})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(r,{variant:"body2",sx:{minWidth:100},children:"Repeat on *"}),e.jsx(u,{size:"small",type:"number",value:n.repeatOn,onChange:s=>d("repeatOn",parseInt(s.target.value)||1),sx:{width:80}}),e.jsx(r,{variant:"body2",sx:{ml:1},children:"st day of the month"}),e.jsx(b,{size:16,color:"#666"})]}),e.jsxs(a,{children:[e.jsxs(r,{variant:"body2",sx:{mb:1,display:"flex",alignItems:"center",gap:1},children:["Expense applies to",e.jsx(b,{size:16,color:"#666"})]}),e.jsxs(Ce,{value:n.expenseAppliesTo,onChange:s=>d("expenseAppliesTo",s.target.value),children:[e.jsx($,{value:"Listings",control:e.jsx(U,{}),label:"Listings"}),e.jsx($,{value:"Owners",control:e.jsx(U,{}),label:"Owners"})]})]}),e.jsxs(w,{fullWidth:!0,children:[e.jsx(N,{children:"Listing(s)"}),e.jsxs(k,{label:"Listing(s)",value:n.listings,onChange:s=>d("listings",s.target.value),children:[e.jsx(o,{value:"all",children:"All Listings"}),e.jsx(o,{value:"listing1",children:"Via di Acqua Bullicante 113"}),e.jsx(o,{value:"listing2",children:"Stylish Apt | Balcony + AC + Aqueduct View"}),e.jsx(o,{value:"listing3",children:"Navigli"})]})]}),e.jsxs(a,{sx:{display:"flex",gap:2,mt:4},children:[e.jsx(h,{fullWidth:!0,variant:"outlined",onClick:E,children:"Cancel"}),e.jsx(h,{fullWidth:!0,variant:"contained",onClick:Z,sx:{bgcolor:"primary.main","&:hover":{bgcolor:"primary.dark"}},children:l!=null&&l.isDuplicating?"Duplicate":l?"Update":"Create"})]})]})]}),e.jsxs(Ae,{open:K,onClose:O,children:[e.jsx(Te,{children:"Delete Automation"}),e.jsx(De,{children:e.jsxs(r,{children:['Are you sure you want to delete "',y==null?void 0:y.name,'"? This action cannot be undone.']})}),e.jsxs(Ie,{children:[e.jsx(h,{onClick:O,children:"Cancel"}),e.jsx(h,{onClick:ne,color:"error",variant:"contained",children:"Delete"})]})]})]})}export{es as AutomationsView};
