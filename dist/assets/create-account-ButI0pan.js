import{c as ce,G as ge,H as me,r as x,j as e,B as n,A as ue,T as l,L as $,a as I,J as q,e as u,g as f,I as J,C as U}from"./index-DDMGUD-_.js";import{C as k}from"./Card-C1fEEBVz.js";import{C as L}from"./CardContent-Bmb6KKQR.js";import{B as xe}from"./Breadcrumbs-C4RG1gWe.js";import{C as he}from"./camera-DQrW7rKh.js";import{U as pe}from"./upload-DcK8EMNO.js";import{F as fe}from"./FormControlLabel-nlFIIXjS.js";import{S as je}from"./Switch-CS1Ni3s3.js";import{T as g}from"./TextField-BZcg-6kp.js";import{F as y}from"./FormControl-BRgYzLHi.js";import{I as v}from"./InputLabel-B_w9HMQG.js";import{S as C}from"./Select-DixiLax7.js";import{E as G}from"./eye-off-DfyncgOK.js";import{E as H}from"./eye-BdeNJELB.js";import{A as W}from"./Autocomplete-C54stYXw.js";import{S as D}from"./search-BrcmRr-v.js";import"./SwitchBase-s8UEUZOy.js";import"./Menu-Bm1ShPnp.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ye=ce("user-plus",be),z=()=>{const r=JSON.parse(localStorage.getItem("clients")||"[]");if(r.length===0){const o=[{id:"client1",name:"Luxury Rentals LLC",email:"contact@luxuryrentals.com",status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"client2",name:"Vacation Homes Inc",email:"info@vacationhomes.com",status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"client3",name:"Premium Properties",email:"hello@premiumprops.com",status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"client4",name:"Elite Stays",email:"support@elitestays.com",status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}];return localStorage.setItem("clients",JSON.stringify(o)),o}return r},M=[{id:"305034",name:"La Dimora Del Cavaliere",location:"Anguillara Sabazia, Italy",clientId:"client1"},{id:"305035",name:"Navigli",location:"Milano, Italy",clientId:"client1"},{id:"305225",name:"Polacchi42",location:"Roma, Italy",clientId:"client2"},{id:"305421",name:"Superattico - Via Del Corso 43",location:"Roma, Italy",clientId:"client2"},{id:"306532",name:"Montecatini Terme",location:"Montecatini Terme, Italy",clientId:"client3"},{id:"306533",name:"Tuscany Villa",location:"Florence, Italy",clientId:"client3"},{id:"306534",name:"Coastal Retreat",location:"Amalfi, Italy",clientId:"client4"}],ve={associate:"Lowest level workers with basic access to assigned properties",supervisor:"Manages Associates and has elevated access to assigned properties",manager:"Super admins with full access to all properties and system management"};function qe({userToEdit:r,viewMode:o=!1,onClose:j}={}){const b=ge(),{createUser:_,updateUser:Z,isLoading:S}=me(),[t,h]=x.useState({name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",password:"",confirmPassword:"",role:(r==null?void 0:r.role)||"",status:(r==null?void 0:r.status)||"active",assignedClients:(r==null?void 0:r.assignedClients)||[],assignedProperties:(r==null?void 0:r.assignedProperties)||[],assignedUsers:(r==null?void 0:r.assignedUsers)||[],assignedManager:(r==null?void 0:r.assignedManager)||"",assignedSupervisor:(r==null?void 0:r.assignedSupervisor)||"",phone:"",company:"Hostaway Inc",country:"United States",state:"",city:"",address:"",zipCode:""}),[w,K]=x.useState(!1),[P,Q]=x.useState(!1),[O,m]=x.useState(""),[V,X]=x.useState(!1),[Y,T]=x.useState(!0),[p,E]=x.useState((r==null?void 0:r.avatar)||null),R=x.useRef(null),A=()=>JSON.parse(localStorage.getItem("createdUsers")||"[]").filter(a=>a.role==="associate"),ee=()=>JSON.parse(localStorage.getItem("createdUsers")||"[]").filter(a=>a.role==="manager"),se=()=>JSON.parse(localStorage.getItem("createdUsers")||"[]").filter(a=>a.role==="supervisor"),F=()=>t.assignedClients.length===0?[]:M.filter(s=>t.assignedClients.includes(s.clientId)),d=(s,a)=>{h(i=>({...i,[s]:a})),m("")},ae=s=>{h(a=>{const i=a.assignedClients.includes(s)?a.assignedClients.filter(c=>c!==s):[...a.assignedClients,s];return{...a,assignedClients:i,assignedProperties:[]}})},te=s=>{h(a=>({...a,assignedProperties:a.assignedProperties.includes(s)?a.assignedProperties.filter(i=>i!==s):[...a.assignedProperties,s]}))},re=s=>{h(a=>({...a,assignedUsers:a.assignedUsers.includes(s)?a.assignedUsers.filter(i=>i!==s):[...a.assignedUsers,s]}))},ne=s=>{var i;const a=(i=s.target.files)==null?void 0:i[0];if(a){if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(a.type)){m("Please select a valid image file (JPEG, JPG, PNG, or GIF)");return}if(a.size>3*1024*1024){m("File size must be less than 3MB");return}const B=new FileReader;B.onload=de=>{var N;E((N=de.target)==null?void 0:N.result),m("")},B.readAsDataURL(a)}},ie=()=>{var s;(s=R.current)==null||s.click()},le=()=>t.name.trim()?t.email.trim()?t.email.includes("@")?t.password?t.password.length<6?(m("Password must be at least 6 characters"),!1):t.password!==t.confirmPassword?(m("Passwords do not match"),!1):t.role?!0:(m("Please select a role"),!1):(m("Password is required"),!1):(m("Please enter a valid email address"),!1):(m("Email is required"),!1):(m("Name is required"),!1),oe=async s=>{if(s.preventDefault(),!!le())try{let a=!1;r?a=await Z(r.id,{name:t.name,email:t.email,role:t.role,status:t.status,assignedClients:t.assignedClients,assignedProperties:t.assignedProperties,assignedUsers:t.assignedUsers,assignedManager:t.assignedManager,assignedSupervisor:t.assignedSupervisor,avatar:p||void 0}):a=await _({name:t.name,email:t.email,role:t.role,status:t.status,assignedClients:t.assignedClients,assignedProperties:t.assignedProperties,assignedUsers:t.assignedUsers,assignedManager:t.assignedManager,assignedSupervisor:t.assignedSupervisor,avatar:p||void 0}),a?(X(!0),setTimeout(()=>{j?j():b("/user-management")},2e3)):m(`Failed to ${r?"update":"create"} account. Please try again.`)}catch{m("An error occurred. Please try again.")}};return V?e.jsx(n,{sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:e.jsx(k,{sx:{maxWidth:400,width:"100%",mx:2},children:e.jsxs(L,{sx:{textAlign:"center",p:4},children:[e.jsx(ue,{sx:{width:64,height:64,mx:"auto",mb:2,bgcolor:"success.main"},children:e.jsx(ye,{size:32})}),e.jsx(l,{variant:"h5",gutterBottom:!0,children:r?"Account Updated Successfully!":"Account Created Successfully!"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:r?"The user account has been updated successfully.":"The new user account has been created and can now log in with their assigned role."})]})})}):e.jsx(n,{sx:{p:3,backgroundColor:"#f5f5f5",minHeight:"100vh"},children:e.jsxs(n,{sx:{maxWidth:1200,mx:"auto"},children:[e.jsxs(xe,{sx:{mb:3},children:[e.jsx($,{color:"inherit",href:"/",onClick:s=>{s.preventDefault(),b("/")},children:"Dashboard"}),e.jsx($,{color:"inherit",href:"/user-management",onClick:s=>{s.preventDefault(),b("/user-management")},children:"User Management"}),e.jsx(l,{color:"text.primary",children:o?"View Account":r?"Edit Account":"Create Account"})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",lg:"300px 1fr"},gap:3},children:[e.jsx(k,{sx:{height:"fit-content"},children:e.jsxs(L,{sx:{p:3},children:[e.jsxs(n,{sx:{mb:3},children:[e.jsx(l,{variant:"subtitle2",sx:{mb:1},children:"Status"}),e.jsx(n,{sx:{display:"flex",gap:1},children:e.jsx(n,{sx:{px:2,py:.5,borderRadius:1,backgroundColor:"#fff3e0",color:"#ef6c00",fontSize:"0.75rem",fontWeight:600},children:"Pending"})})]}),e.jsxs(n,{sx:{textAlign:"center",mb:3},children:[e.jsxs(n,{sx:{position:"relative",display:"inline-block",cursor:"pointer",width:120,height:120,borderRadius:"50%",overflow:"hidden","&:hover .upload-overlay":{opacity:1},"&:hover .avatar-circle":{borderColor:"primary.main",borderWidth:2}},onClick:ie,children:[e.jsx(n,{className:"avatar-circle",sx:{width:120,height:120,mx:"auto",mb:2,borderRadius:"50%",border:"2px dashed",borderColor:p?"transparent":"grey.400",backgroundColor:p?"transparent":"grey.100",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",backgroundImage:p?`url(${p})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",overflow:"hidden"},children:!p&&e.jsxs(n,{sx:{textAlign:"center",color:"grey.500"},children:[e.jsx(he,{size:32}),e.jsx(l,{variant:"caption",sx:{display:"block",mt:.5,fontSize:"0.7rem"},children:"Upload photo"})]})}),e.jsx(n,{className:"upload-overlay",sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,transition:"opacity 0.3s ease",cursor:"pointer",zIndex:1},children:e.jsxs(n,{sx:{textAlign:"center",color:"white"},children:[e.jsx(pe,{size:24}),e.jsx(l,{variant:"caption",sx:{display:"block",mt:.5},children:"Upload photo"})]})})]}),e.jsx(l,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:"Allowed *.jpeg, *.jpg, *.png, *.gif"}),e.jsx(l,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:2},children:"max size of 3 Mb"}),e.jsx("input",{ref:R,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:ne,style:{display:"none"}})]}),e.jsx(n,{sx:{mb:3},children:e.jsx(fe,{control:e.jsx(je,{checked:Y,onChange:s=>T(s.target.checked),color:"success"}),label:e.jsxs(n,{children:[e.jsx(l,{variant:"body2",sx:{fontWeight:500},children:"Email verified"}),e.jsx(l,{variant:"caption",color:"text.secondary",children:"Disabling this will automatically send the user a verification email"})]})})}),e.jsx(I,{variant:"contained",color:"error",fullWidth:!0,disabled:!0,sx:{mb:2},children:"Delete user"})]})}),e.jsx(k,{children:e.jsxs(L,{sx:{p:3},children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"User Information"}),O&&e.jsx(q,{severity:"error",sx:{mb:3},children:O}),e.jsxs(n,{component:"form",onSubmit:oe,children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,mb:2},children:[e.jsx(g,{fullWidth:!0,disabled:o,label:"Full name",value:t.name,onChange:s=>d("name",s.target.value),required:!0}),e.jsx(g,{fullWidth:!0,disabled:o,label:"Email address",type:"email",value:t.email,onChange:s=>d("email",s.target.value),required:!0})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,mb:2},children:[e.jsx(g,{fullWidth:!0,disabled:o,label:"Phone number",value:t.phone,onChange:s=>d("phone",s.target.value)}),e.jsx(g,{fullWidth:!0,disabled:o,label:"Company",value:t.company,onChange:s=>d("company",s.target.value)})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,mb:2},children:[e.jsx(g,{fullWidth:!0,disabled:o,label:"Country",value:t.country,onChange:s=>d("country",s.target.value)}),e.jsx(g,{fullWidth:!0,disabled:o,label:"State/Region",value:t.state,onChange:s=>d("state",s.target.value)})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,mb:2},children:[e.jsx(g,{fullWidth:!0,disabled:o,label:"City",value:t.city,onChange:s=>d("city",s.target.value)}),e.jsx(g,{fullWidth:!0,disabled:o,label:"Address",value:t.address,onChange:s=>d("address",s.target.value)})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,mb:2},children:[e.jsx(g,{fullWidth:!0,disabled:o,label:"Zip/Code",value:t.zipCode,onChange:s=>d("zipCode",s.target.value)}),e.jsxs(y,{fullWidth:!0,children:[e.jsx(v,{children:"Role"}),e.jsxs(C,{disabled:o,value:t.role,onChange:s=>d("role",s.target.value),label:"Role",children:[e.jsx(u,{value:"associate",children:"Associate"}),e.jsx(u,{value:"supervisor",children:"Supervisor"}),e.jsx(u,{value:"manager",children:"Manager"})]})]}),e.jsxs(y,{fullWidth:!0,children:[e.jsx(v,{children:"Status"}),e.jsxs(C,{disabled:o,value:t.status,onChange:s=>d("status",s.target.value),label:"Status",children:[e.jsx(u,{value:"active",children:"Active"}),e.jsx(u,{value:"inactive",children:"Inactive"}),e.jsx(u,{value:"suspended",children:"Suspended"})]})]})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,mb:3},children:[e.jsx(g,{fullWidth:!0,disabled:o,label:"Password",type:w?"text":"password",value:t.password,onChange:s=>d("password",s.target.value),required:!0,InputProps:{endAdornment:e.jsx(f,{position:"end",children:e.jsx(J,{onClick:()=>K(!w),edge:"end",children:w?e.jsx(G,{size:20}):e.jsx(H,{size:20})})})}}),e.jsx(g,{fullWidth:!0,disabled:o,label:"Confirm Password",type:P?"text":"password",value:t.confirmPassword,onChange:s=>d("confirmPassword",s.target.value),required:!0,InputProps:{endAdornment:e.jsx(f,{position:"end",children:e.jsx(J,{onClick:()=>Q(!P),edge:"end",children:P?e.jsx(G,{size:20}):e.jsx(H,{size:20})})})}})]}),t.role&&e.jsxs(n,{sx:{mb:3},children:[e.jsx(l,{variant:"subtitle2",gutterBottom:!0,children:"Role Description"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:ve[t.role]})]}),t.role==="associate"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"subtitle2",gutterBottom:!0,children:"Assign Clients"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"First, select which clients this user will work with:"}),t.assignedClients.length>0&&e.jsxs(n,{sx:{mb:2},children:[e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{mb:1,display:"block"},children:["Selected Clients (",t.assignedClients.length,"):"]}),e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.assignedClients.map(s=>{const a=z().find(i=>i.id===s);return e.jsx(U,{label:a?a.name:`Client ${s}`,onDelete:()=>ae(s),color:"secondary",variant:"outlined",size:"small"},s)})})]}),e.jsx(W,{multiple:!0,disabled:o,options:z(),getOptionLabel:s=>`${s.name} (${s.email})`,value:z().filter(s=>t.assignedClients.includes(s.id)),onChange:(s,a)=>{const i=a.map(c=>c.id);h(c=>({...c,assignedClients:i,assignedProperties:[]}))},filterOptions:(s,{inputValue:a})=>s.filter(i=>i.name.toLowerCase().includes(a.toLowerCase())||i.email.toLowerCase().includes(a.toLowerCase())||i.id.includes(a)),renderInput:s=>e.jsx(g,{...s,placeholder:"Search and select clients...",InputProps:{...s.InputProps,startAdornment:e.jsx(f,{position:"start",children:e.jsx(D,{size:20})})}}),renderOption:(s,a)=>e.jsx(n,{component:"li",...s,children:e.jsxs(n,{children:[e.jsx(l,{variant:"body2",sx:{fontWeight:500},children:a.name}),e.jsx(l,{variant:"caption",color:"text.secondary",children:a.email})]})}),renderTags:()=>null,sx:{mb:3}}),e.jsx(l,{variant:"subtitle2",gutterBottom:!0,children:"Assign Manager & Supervisor"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Select which Manager and Supervisor will oversee this Associate:"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,mb:3},children:[e.jsxs(y,{fullWidth:!0,children:[e.jsx(v,{children:"Manager"}),e.jsxs(C,{disabled:o,value:t.assignedManager,onChange:s=>d("assignedManager",s.target.value),label:"Manager",children:[e.jsx(u,{value:"",children:e.jsx("em",{children:"No Manager Assigned"})}),ee().map(s=>e.jsxs(u,{value:s.id,children:[s.name," (",s.email,")"]},s.id))]})]}),e.jsxs(y,{fullWidth:!0,children:[e.jsx(v,{children:"Supervisor"}),e.jsxs(C,{disabled:o,value:t.assignedSupervisor,onChange:s=>d("assignedSupervisor",s.target.value),label:"Supervisor",children:[e.jsx(u,{value:"",children:e.jsx("em",{children:"No Supervisor Assigned"})}),se().map(s=>e.jsxs(u,{value:s.id,children:[s.name," (",s.email,")"]},s.id))]})]})]}),e.jsx(l,{variant:"subtitle2",gutterBottom:!0,children:"Assign Properties"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Then, select which properties from the assigned clients this user will have access to:"}),t.assignedClients.length===0&&e.jsx(q,{severity:"info",sx:{mb:2},children:"Please select clients first to see their available properties."}),t.assignedProperties.length>0&&e.jsxs(n,{sx:{mb:2},children:[e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{mb:1,display:"block"},children:["Selected Properties (",t.assignedProperties.length,"):"]}),e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.assignedProperties.map(s=>{const a=M.find(i=>i.id===s);return e.jsx(U,{label:a?a.name:`Property ${s}`,onDelete:()=>te(s),color:"primary",variant:"outlined",size:"small"},s)})})]}),e.jsx(W,{multiple:!0,disabled:t.assignedClients.length===0||o,options:F(),getOptionLabel:s=>`${s.name} (${s.location})`,value:F().filter(s=>t.assignedProperties.includes(s.id)),onChange:(s,a)=>{const i=a.map(c=>c.id);h(c=>({...c,assignedProperties:i}))},filterOptions:(s,{inputValue:a})=>s.filter(i=>i.name.toLowerCase().includes(a.toLowerCase())||i.location.toLowerCase().includes(a.toLowerCase())||i.id.includes(a)),renderInput:s=>e.jsx(g,{...s,placeholder:"Search and select properties...",InputProps:{...s.InputProps,startAdornment:e.jsx(f,{position:"start",children:e.jsx(D,{size:20})})}}),renderOption:(s,a)=>e.jsx(n,{component:"li",...s,children:e.jsxs(n,{children:[e.jsx(l,{variant:"body2",sx:{fontWeight:500},children:a.name}),e.jsxs(l,{variant:"caption",color:"text.secondary",children:[a.location," (ID: ",a.id,")"]})]})}),renderTags:()=>null,sx:{mb:2}})]}),(t.role==="supervisor"||t.role==="manager")&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"subtitle2",gutterBottom:!0,children:"Assign Users"}),e.jsxs(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Select which Associates this ",t.role," will manage:"]}),t.assignedUsers.length>0&&e.jsxs(n,{sx:{mb:2},children:[e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{mb:1,display:"block"},children:["Selected Users (",t.assignedUsers.length,"):"]}),e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.assignedUsers.map(s=>{const a=A().find(i=>i.id===s);return e.jsx(U,{label:a?a.name:`User ${s}`,onDelete:()=>re(s),color:"info",variant:"outlined",size:"small"},s)})})]}),e.jsx(W,{multiple:!0,disabled:o,options:A(),getOptionLabel:s=>`${s.name} (${s.email})`,value:A().filter(s=>t.assignedUsers.includes(s.id)),onChange:(s,a)=>{const i=a.map(c=>c.id);h(c=>({...c,assignedUsers:i}))},filterOptions:(s,{inputValue:a})=>s.filter(i=>i.name.toLowerCase().includes(a.toLowerCase())||i.email.toLowerCase().includes(a.toLowerCase())||i.id.includes(a)),renderInput:s=>e.jsx(g,{...s,placeholder:"Search and select users to manage...",InputProps:{...s.InputProps,startAdornment:e.jsx(f,{position:"start",children:e.jsx(D,{size:20})})}}),renderOption:(s,a)=>e.jsx(n,{component:"li",...s,children:e.jsxs(n,{children:[e.jsx(l,{variant:"body2",sx:{fontWeight:500},children:a.name}),e.jsx(l,{variant:"caption",color:"text.secondary",children:a.email})]})}),renderTags:()=>null,sx:{mb:2}})]}),e.jsxs(n,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(I,{variant:"outlined",onClick:()=>j?j():b("/user-management"),disabled:S,children:o?"Close":"Cancel"}),!o&&e.jsx(I,{type:"submit",variant:"contained",disabled:S,children:S?r?"Updating Account...":"Creating Account...":r?"Update Account":"Create Account"})]})]})]})})]})]})})}export{qe as CreateAccountPage};
