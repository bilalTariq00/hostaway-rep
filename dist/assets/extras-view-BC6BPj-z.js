import{D as tt,r,j as e,B as a,T as i,a as o,e as c,a4 as M,g as Y,I as u,a5 as pe,V as nt,P as st}from"./index-DDMGUD-_.js";import{D as at}from"./content-DAzX26cm.js";import{U as ge}from"./upload-DcK8EMNO.js";import{D as rt}from"./download-BkC7-9GN.js";import{M as je}from"./Menu-Bm1ShPnp.js";import{P as fe}from"./plus-0dYUhXY5.js";import{T as it,a as F}from"./Tabs-DQ5TNJO7.js";import{F as ot}from"./funnel-Prn9gWG1.js";import{T as p}from"./TextField-BZcg-6kp.js";import{S as Ce}from"./search-BrcmRr-v.js";import{T as lt}from"./TableContainer-Cp4gnwML.js";import{T as ct,a as dt,b as ye,c as C,d as ht}from"./TableHead-CMCmgIDA.js";import{C as G}from"./Checkbox-DrgNyHeB.js";import{S as xt}from"./settings-CTSlhn1k.js";import{P as mt}from"./paperclip-CTO_dT--.js";import{C as be}from"./copy-BBA9hbF8.js";import{P as ut}from"./pencil-Cjn288Y-.js";import{C as pt}from"./calendar-C8D0Jpcj.js";import{M as gt}from"./minus-DE8k5glY.js";import{F as B}from"./FormControl-BRgYzLHi.js";import{I as N}from"./InputLabel-B_w9HMQG.js";import{S as O}from"./Select-DixiLax7.js";import{D as _,a as J,b as Q,c as Z}from"./DialogContent-CkHDAA-B.js";import{F as jt}from"./FormControlLabel-nlFIIXjS.js";import"./KeyboardArrowRight-D6UvfiY9.js";import"./SwitchBase-s8UEUZOy.js";const ft=[{id:1,name:"Prenotazione Fuori Portale",date:"2025-09-01",category:"",listing:"Via di Acqua Bullicante 113",reservation:"",owner:"",ownerStatement:"Via Acqua Bulicante - DF Method September [Da Pagare]",amount:900,hasAttachment:!0},{id:2,name:"Prenotazione Fuori Portale",date:"2025-09-01",category:"",listing:"Stylish Apt | Balcony + AC + Aqueduct View",reservation:"",owner:"",ownerStatement:"Circ. Casilina 151 - DF Method September [Da Pagare]",amount:1300,hasAttachment:!0},{id:3,name:"A2A Energia S.P.A",date:"2025-08-30",category:"",listing:"Navigli",reservation:"",owner:"",ownerStatement:"Navigli - DF Method August [Da Pubblicare]",amount:136,hasAttachment:!0},{id:4,name:"Guadagno Maggio Totale [Booking]",date:"2025-06-30",category:"",listing:"Elegant 2BR Apt | Balcony, AC, Near Colosseum",reservation:"",owner:"",ownerStatement:"",amount:2841.57,hasAttachment:!0},{id:5,name:"Check In di Persona [Domus Omaggio]",date:"2025-05-31",category:"",listing:"Elegant Roman Escape • Walk to the Colosseum",reservation:"",owner:"",ownerStatement:"DF - Elegant Roman Escape • Walk to the Colosseum May 2025",amount:120,hasAttachment:!0}],S=[{key:"name",label:"Name",sortable:!0,mandatory:!0},{key:"date",label:"Date",sortable:!0,mandatory:!1},{key:"categories",label:"Categories",sortable:!1,mandatory:!1},{key:"listing",label:"Listing",sortable:!0,mandatory:!1},{key:"reservation",label:"Reservation",sortable:!1,mandatory:!1},{key:"owner",label:"Owner",sortable:!1,mandatory:!1},{key:"ownerStatement",label:"Owner statements",sortable:!1,mandatory:!1},{key:"amount",label:"Amount",sortable:!0,mandatory:!1}];function Ht(){const A=tt(),[ve,ke]=r.useState(1),[D,V]=r.useState([]),[g,y]=r.useState(1),[z]=r.useState(5),[K,we]=r.useState(""),[Se,b]=r.useState(!1),[Ae,ee]=r.useState(!1),[De,te]=r.useState(!1),[ne,se]=r.useState(null),[v,E]=r.useState(ft),[d,I]=r.useState(null),[ze,R]=r.useState(!1),[k,L]=r.useState(null),[ae,re]=r.useState(null),[ie,Ee]=r.useState(""),[j,Ie]=r.useState(""),[W,oe]=r.useState("asc"),[T,We]=r.useState(S.slice(0,8).map(t=>t.key)),[le,ce]=r.useState(null),[h,de]=r.useState(null),[l,f]=r.useState({extraName:"",description:"",date:"2025-10-09",amount:0,categories:"",listing:"",reservation:"",owner:""}),Te=(t,n)=>{ke(n),n===0&&A.push("/expenses-extras/expenses"),n===2&&A.push("/expenses-extras/categories"),n===3&&A.push("/expenses-extras/automations")},x=(t,n)=>{f(s=>({...s,[t]:n}))},he=t=>{f(n=>({...n,amount:Math.max(0,n.amount+t)}))},Pe=()=>{const t={id:Math.max(...v.map(n=>n.id))+1,name:l.extraName||"New Extra",date:l.date,category:l.categories,listing:l.listing,reservation:l.reservation,owner:l.owner,ownerStatement:l.description,amount:l.amount,hasAttachment:!1};d?d.isDuplicating?E(n=>[...n,t]):E(n=>n.map(s=>s.id===d.id?{...t,id:d.id}:s)):E(n=>[...n,t]),b(!1),I(null),f({extraName:"",description:"",date:"2025-10-09",amount:0,categories:"",listing:"",reservation:"",owner:""})},xe=t=>{I(t),f({extraName:t.name,description:t.ownerStatement,date:t.date,amount:t.amount,categories:t.category,listing:t.listing,reservation:t.reservation,owner:t.owner}),b(!0)},Me=t=>{I({...t,isDuplicating:!0}),f({extraName:`${t.name} (Copy)`,description:t.ownerStatement,date:new Date().toISOString().split("T")[0],amount:t.amount,categories:t.category,listing:t.listing,reservation:t.reservation,owner:t.owner}),b(!0)},q=()=>{b(!1),I(null),f({extraName:"",description:"",date:"2025-10-09",amount:0,categories:"",listing:"",reservation:"",owner:""})},Fe=t=>{L(t),R(!0)},Be=()=>{k&&E(t=>t.filter(n=>n.id!==k.id)),R(!1),L(null)},me=()=>{R(!1),L(null)},Ne=t=>{re(t.currentTarget)},Oe=()=>{re(null)},Ve=t=>{const n=S.find(s=>s.key===t);n!=null&&n.mandatory||We(s=>s.includes(t)?s.filter(m=>m!==t):[...s,t])},Re=t=>{j===t?oe(n=>n==="asc"?"desc":"asc"):(Ie(t),oe("asc"))},Le=(t,n)=>{ce(t.currentTarget),de(n)},U=()=>{ce(null),de(null)},qe=()=>{const t=document.createElement("input");t.type="file",t.multiple=!0,t.accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt",t.onchange=n=>{const s=n.target.files;s&&s.length>0&&(console.log(`Uploading ${s.length} file(s) for extra: ${h==null?void 0:h.name}`),alert(`Successfully uploaded ${s.length} file(s) for "${h==null?void 0:h.name}"`))},t.click(),U()},Ue=()=>{console.log(`Copying attachment for extra: ${h==null?void 0:h.name}`),alert(`Copying attachment for "${h==null?void 0:h.name}"`),U()},$e=t=>{t.target.checked?V(v.map(n=>n.id)):V([])},He=t=>{V(n=>n.includes(t)?n.filter(s=>s!==t):[...n,t])},Xe=t=>{se(t.currentTarget)},P=()=>{se(null)},Ye=()=>{b(!0)},Ge=()=>{ee(!0)},$=()=>{ee(!1)},_e=()=>{te(!0)},H=()=>{te(!1)},X=v.filter(t=>t.name.toLowerCase().includes(K.toLowerCase())),Je=[...X].sort((t,n)=>{if(!j)return 0;const s=t[j],m=n[j];return typeof s=="string"&&typeof m=="string"?W==="asc"?s.localeCompare(m):m.localeCompare(s):typeof s=="number"&&typeof m=="number"?W==="asc"?s-m:m-s:0}),Qe=S.filter(t=>t.label.toLowerCase().includes(ie.toLowerCase())),Ze=X.reduce((t,n)=>t+n.amount,0),w=Math.ceil(X.length/z),ue=(g-1)*z,Ke=ue+z,et=Je.slice(ue,Ke);return e.jsxs(at,{maxWidth:"xl",children:[e.jsxs(a,{sx:{mb:3},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(i,{variant:"h4",sx:{fontWeight:600},children:"Expenses and Extras"}),e.jsxs(a,{sx:{display:"flex",gap:1},children:[e.jsx(o,{variant:"outlined",onClick:Ge,startIcon:e.jsx(ge,{size:16}),children:"Import"}),e.jsx(o,{variant:"outlined",onClick:Xe,endIcon:e.jsx(rt,{size:16}),children:"Download Report"}),e.jsxs(je,{anchorEl:ne,open:!!ne,onClose:P,children:[e.jsx(c,{onClick:P,children:"Export CSV"}),e.jsx(c,{onClick:P,children:"Export Excel"}),e.jsx(c,{onClick:P,children:"Export PDF"})]}),e.jsx(o,{variant:"contained",onClick:Ye,startIcon:e.jsx(fe,{size:16}),children:"Add Extra"})]})]}),e.jsxs(it,{value:ve,onChange:Te,sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{textTransform:"none",fontWeight:500},"& .Mui-selected":{color:"primary.main",fontWeight:600},"& .MuiTabs-indicator":{bgcolor:"primary.main"}},children:[e.jsx(F,{label:"Expenses"}),e.jsx(F,{label:"Extras"}),e.jsx(F,{label:"Categories"}),e.jsx(F,{label:"Automations"})]})]}),e.jsx(a,{sx:{mb:3},children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(i,{variant:"h5",sx:{fontWeight:600},children:"Extras"}),e.jsx(o,{variant:"outlined",onClick:_e,children:"New Custom View"})]})}),e.jsx(M,{sx:{p:2,mb:3},children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(o,{variant:"outlined",startIcon:e.jsx(ot,{size:16}),children:"Filter"}),e.jsx(p,{size:"small",placeholder:"Search by name...",value:K,onChange:t=>we(t.target.value),InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(Ce,{size:16,color:"#666"})})},sx:{minWidth:250}})]})}),e.jsx(M,{sx:{borderRadius:2,overflow:"hidden",mb:3},children:e.jsx(lt,{sx:{maxHeight:600,overflowY:"auto",overflowX:"auto"},children:e.jsxs(ct,{sx:{minWidth:T.length*120},children:[e.jsx(dt,{sx:{bgcolor:"grey.50"},children:e.jsxs(ye,{children:[e.jsx(C,{padding:"checkbox",sx:{fontWeight:600},children:e.jsx(G,{indeterminate:D.length>0&&D.length<v.length,checked:D.length===v.length,onChange:$e})}),S.map(t=>T.includes(t.key)&&e.jsx(C,{sx:{fontWeight:600,minWidth:120,whiteSpace:"nowrap",cursor:t.sortable?"pointer":"default","&:hover":t.sortable?{bgcolor:"grey.100"}:{}},onClick:()=>t.sortable&&Re(t.key),children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.label,t.sortable&&e.jsxs(a,{sx:{display:"flex",flexDirection:"column",ml:.5},children:[e.jsx(a,{sx:{fontSize:"10px",lineHeight:1},children:j===t.key&&W==="asc"?"▲":"△"}),e.jsx(a,{sx:{fontSize:"10px",lineHeight:1},children:j===t.key&&W==="desc"?"▼":"▽"})]})]})},t.key)),e.jsx(C,{sx:{position:"sticky",right:0,bgcolor:"background.paper",borderLeft:"1px solid",borderColor:"divider",zIndex:10,px:0},children:e.jsx(u,{size:"small",onClick:Ne,sx:{color:"text.secondary","&:hover":{bgcolor:"grey.100",color:"text.primary"}},children:e.jsx(xt,{size:16})})})]})}),e.jsx(ht,{children:et.map((t,n)=>e.jsxs(ye,{sx:{"&:hover":{bgcolor:"grey.50"}},children:[e.jsx(C,{padding:"checkbox",children:e.jsx(G,{checked:D.includes(t.id),onChange:()=>He(t.id)})}),S.map(s=>T.includes(s.key)&&e.jsxs(C,{sx:{minWidth:120,whiteSpace:"nowrap"},children:[s.key==="name"&&e.jsx(i,{variant:"body2",sx:{fontWeight:500,color:"primary.main",cursor:"pointer","&:hover":{color:"primary.dark"}},onClick:()=>xe(t),children:t.name}),s.key==="date"&&e.jsx(i,{variant:"body2",sx:{color:"text.secondary"},children:t.date}),s.key==="categories"&&e.jsx(i,{variant:"body2",sx:{color:"text.secondary"},children:"—"}),s.key==="listing"&&e.jsx(i,{variant:"body2",sx:{color:"primary.main",cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>A.push("/listings/1"),children:t.listing}),s.key==="reservation"&&e.jsx(i,{variant:"body2",sx:{color:"text.secondary"},children:"—"}),s.key==="owner"&&e.jsx(i,{variant:"body2",sx:{color:"text.secondary"},children:"—"}),s.key==="ownerStatement"&&e.jsx(i,{variant:"body2",sx:{color:"primary.main",cursor:"pointer","&:hover":{textDecoration:"underline"}},children:t.ownerStatement}),s.key==="amount"&&e.jsxs(i,{variant:"body2",sx:{fontWeight:600,color:"primary.main"},children:["€",t.amount.toFixed(2)]})]},s.key)),e.jsx(C,{sx:{position:"sticky",right:0,bgcolor:n%2===0?"white":"grey.50",borderLeft:"1px solid",borderColor:"divider",zIndex:10,px:0},children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(u,{size:"small",onClick:s=>Le(s,t),sx:{color:t.hasAttachment?"primary.main":"text.secondary","&:hover":{bgcolor:"grey.100"}},children:e.jsx(mt,{size:16})}),e.jsx(u,{size:"small",onClick:()=>Me(t),children:e.jsx(be,{size:16})}),e.jsx(u,{size:"small",onClick:()=>xe(t),children:e.jsx(ut,{size:16})}),e.jsx(u,{size:"small",onClick:()=>Fe(t),children:e.jsx(pe,{size:16,color:"#ef4444"})})]})})]},t.id))})]})})}),e.jsx(M,{sx:{p:2,mb:2},children:e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(i,{variant:"h6",sx:{fontWeight:600},children:"TOTAL"}),e.jsxs(i,{variant:"h6",sx:{fontWeight:600,color:"primary.main"},children:["€",Ze.toFixed(2)]})]})}),e.jsx(M,{sx:{p:2},children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:2},children:[e.jsxs(i,{variant:"body2",color:"text.secondary",children:["Show ",z," per page"]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(o,{size:"small",variant:"outlined",disabled:g===1,onClick:()=>y(1),children:"FIRST"}),e.jsx(o,{size:"small",variant:"outlined",disabled:g===1,onClick:()=>y(t=>Math.max(1,t-1)),children:"<"}),Array.from({length:Math.min(5,w)},(t,n)=>{const s=n+1;return e.jsx(o,{size:"small",variant:g===s?"contained":"outlined",onClick:()=>y(s),children:s},s)}),e.jsx(o,{size:"small",variant:"outlined",disabled:g===w,onClick:()=>y(t=>Math.min(w,t+1)),children:">"}),e.jsx(o,{size:"small",variant:"outlined",disabled:g===w,onClick:()=>y(w),children:"LAST"})]})]})}),e.jsxs(nt,{anchor:"right",open:Se,onClose:q,sx:{"& .MuiDrawer-paper":{width:400,p:3}},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsx(i,{variant:"h6",sx:{fontWeight:600},children:d!=null&&d.isDuplicating?"Duplicate extra":d?"Edit extra":"Add new extra"}),e.jsx(u,{onClick:q,children:e.jsx(pe,{size:20})})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(p,{fullWidth:!0,label:"Extra name *",placeholder:"Enter extra name...",value:l.extraName,onChange:t=>x("extraName",t.target.value),required:!0}),e.jsx(p,{fullWidth:!0,multiline:!0,rows:4,label:"Description",placeholder:"Enter description...",value:l.description,onChange:t=>x("description",t.target.value)}),e.jsx(p,{fullWidth:!0,type:"date",label:"Date *",value:l.date,onChange:t=>x("date",t.target.value),InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(pt,{size:16})})},required:!0}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(i,{variant:"body2",sx:{minWidth:60},children:"Amount *"}),e.jsx(u,{size:"small",onClick:()=>he(-1),sx:{border:"1px solid",borderColor:"divider"},children:e.jsx(gt,{size:16})}),e.jsx(p,{size:"small",type:"number",value:l.amount,onChange:t=>x("amount",parseFloat(t.target.value)||0),sx:{flex:1}}),e.jsx(u,{size:"small",onClick:()=>he(1),sx:{border:"1px solid",borderColor:"divider"},children:e.jsx(fe,{size:16})})]}),e.jsxs(B,{fullWidth:!0,children:[e.jsx(N,{children:"Categories"}),e.jsxs(O,{label:"Categories",value:l.categories,onChange:t=>x("categories",t.target.value),children:[e.jsx(c,{value:"transportation",children:"Transportation"}),e.jsx(c,{value:"amenities",children:"Amenities"}),e.jsx(c,{value:"services",children:"Services"}),e.jsx(c,{value:"entertainment",children:"Entertainment"})]})]}),e.jsxs(B,{fullWidth:!0,children:[e.jsx(N,{children:"Listing"}),e.jsxs(O,{label:"Listing",value:l.listing,onChange:t=>x("listing",t.target.value),children:[e.jsx(c,{value:"listing1",children:"Via di Acqua Bullicante 113"}),e.jsx(c,{value:"listing2",children:"Stylish Apt | Balcony + AC + Aqueduct View"}),e.jsx(c,{value:"listing3",children:"Navigli"}),e.jsx(c,{value:"listing4",children:"Elegant 2BR Apt | Balcony, AC, Near Colosseum"}),e.jsx(c,{value:"listing5",children:"Elegant Roman Escape • Walk to the Colosseum"})]})]}),e.jsxs(B,{fullWidth:!0,children:[e.jsx(N,{children:"Reservation"}),e.jsx(O,{label:"Reservation",value:l.reservation,onChange:t=>x("reservation",t.target.value),children:e.jsx(c,{value:"",children:"—"})})]}),e.jsxs(B,{fullWidth:!0,children:[e.jsx(N,{children:"Owner"}),e.jsx(O,{label:"Owner",value:l.owner,onChange:t=>x("owner",t.target.value),children:e.jsx(c,{value:"",children:"—"})})]}),e.jsxs(a,{sx:{display:"flex",gap:2,mt:4},children:[e.jsx(o,{fullWidth:!0,variant:"outlined",onClick:q,children:"Cancel"}),e.jsx(o,{fullWidth:!0,variant:"contained",onClick:Pe,sx:{bgcolor:"primary.main","&:hover":{bgcolor:"primary.dark"}},children:d!=null&&d.isDuplicating?"Duplicate":d?"Update":"Create"})]})]})]}),e.jsxs(_,{open:Ae,onClose:$,maxWidth:"sm",fullWidth:!0,children:[e.jsx(J,{children:"Import Data"}),e.jsx(Q,{children:e.jsxs(a,{sx:{p:2,textAlign:"center"},children:[e.jsx(i,{variant:"body1",sx:{mb:2},children:"Upload your extras data file"}),e.jsxs(o,{variant:"contained",component:"label",children:["Choose File",e.jsx("input",{type:"file",hidden:!0})]})]})}),e.jsxs(Z,{children:[e.jsx(o,{onClick:$,children:"Cancel"}),e.jsx(o,{variant:"contained",onClick:$,children:"Import"})]})]}),e.jsxs(_,{open:De,onClose:H,maxWidth:"sm",fullWidth:!0,children:[e.jsx(J,{children:"New Custom View"}),e.jsx(Q,{children:e.jsx(p,{fullWidth:!0,label:"View Name",placeholder:"Enter view name...",sx:{mt:2}})}),e.jsxs(Z,{children:[e.jsx(o,{onClick:H,children:"Cancel"}),e.jsx(o,{variant:"contained",onClick:H,children:"Create View"})]})]}),e.jsx(st,{open:!!ae,anchorEl:ae,onClose:Oe,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(a,{sx:{p:2,minWidth:250},children:[e.jsx(i,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Column Settings"}),e.jsx(p,{size:"small",placeholder:"Find column",value:ie,onChange:t=>Ee(t.target.value),InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(Ce,{size:16})})},sx:{mb:2,width:"100%"}}),e.jsx(a,{sx:{maxHeight:300,overflowY:"auto"},children:Qe.map(t=>e.jsx(jt,{control:e.jsx(G,{checked:T.includes(t.key),onChange:()=>Ve(t.key),disabled:t.mandatory}),label:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.label,t.mandatory&&e.jsx(i,{variant:"caption",color:"text.secondary",children:"(Required)"})]}),sx:{width:"100%",mb:.5}},t.key))})]})}),e.jsxs(je,{anchorEl:le,open:!!le,onClose:U,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[e.jsx(c,{onClick:qe,children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ge,{size:16}),e.jsx(i,{variant:"body2",children:"Upload File"})]})}),e.jsx(c,{onClick:Ue,children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(be,{size:16}),e.jsx(i,{variant:"body2",children:"Copy Attachment"})]})})]}),e.jsxs(_,{open:ze,onClose:me,children:[e.jsx(J,{children:"Delete Extra"}),e.jsx(Q,{children:e.jsxs(i,{children:['Are you sure you want to delete "',k==null?void 0:k.name,'"? This action cannot be undone.']})}),e.jsxs(Z,{children:[e.jsx(o,{onClick:me,children:"Cancel"}),e.jsx(o,{onClick:Be,color:"error",variant:"contained",children:"Delete"})]})]})]})}export{Ht as ExtrasView};
