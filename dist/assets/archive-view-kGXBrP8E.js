import{D as Ce,r as c,j as e,B as x,T as a,a as h,a4 as w,e as l,d,C as H,I as O,P as ke}from"./index-DlK49mD9.js";import{D as Te}from"./content-BncdO-AK.js";import{T as Se,a as D}from"./Tabs-CawWx8bN.js";import{G as v}from"./Grid-CFPLP85A.js";import{F as M}from"./FormControl-DsPW8NaL.js";import{I as z}from"./InputLabel-vBrrCZYs.js";import{S as P}from"./Select-hkki-_gR.js";import{T as Ae}from"./TableContainer-1FovwQIv.js";import{T as Ie,a as we,b as U,c as t,d as Oe}from"./TableHead-BbeVJGli.js";import{P as Me}from"./Pagination-BTzUsZhy.js";import{M as ze}from"./Menu-Cd2TK2zY.js";import{D as V,a as Y,b as _,c as q}from"./DialogContent-BrwwiAlS.js";import{F as Pe}from"./FormControlLabel-DYCM3_AA.js";import{C as Ee}from"./Checkbox-Cws__oH0.js";import"./KeyboardArrowRight-B0juUeOl.js";import"./LastPage-lp5Gj61X.js";import"./SwitchBase-D6K1hBX3.js";const Le=[{id:1,title:"Old Property Inspection",description:"Conduct inspection of old property",status:"Archived",priority:"Low",assignee:"John Doe",supervisor:"Jane Smith",dueDate:"2023-12-15",channel:"Airbnb",listing:"Old Villa",archivedDate:"2024-01-01"},{id:2,title:"Legacy Guest Check-in",description:"Prepare welcome package for old system",status:"Archived",priority:"Medium",assignee:"Mike Johnson",supervisor:"Sarah Wilson",dueDate:"2023-11-20",channel:"Booking.com",listing:"Old Apartment",archivedDate:"2023-12-01"},{id:3,title:"Deprecated Maintenance",description:"Fix old air conditioning system",status:"Archived",priority:"High",assignee:"Tom Brown",supervisor:"Jane Smith",dueDate:"2023-10-30",channel:"Direct",listing:"Old Property",archivedDate:"2023-11-15"}];function Ze(){const u=Ce(),[K,Q]=c.useState(3),[E,X]=c.useState(1),[C]=c.useState(50),[L,B]=c.useState(null),[r,p]=c.useState(null),[Z,k]=c.useState(!1),[ee,f]=c.useState(!1),[se,te]=c.useState(""),[ie,ne]=c.useState(""),[re,ae]=c.useState(""),[J,y]=c.useState([]),[W,N]=c.useState(null),[i,T]=c.useState({task:!0,description:!0,status:!0,priority:!0,assignee:!0,supervisor:!0,group:!0,startDate:!0,endDate:!0,category:!0,listing:!0,channel:!0,reservation:!0,cost:!0,archivedDate:!0}),S=()=>{const s=localStorage.getItem("tasks"),n=localStorage.getItem("archivedTasks");let o=[];return s&&(o=[...o,...JSON.parse(s)]),n&&(o=[...o,...JSON.parse(n)]),o.length===0&&(o=Le),o};c.useEffect(()=>{y(S())},[]),c.useEffect(()=>{const s=()=>{y(S())};return window.addEventListener("focus",s),()=>window.removeEventListener("focus",s)},[]);const le=(s,n)=>{Q(n),n===0&&u.push("/tasks/manage-tasks"),n===1&&u.push("/tasks/manage-auto-tasks"),n===2&&u.push("/tasks/checklist-templates")},oe=(s,n)=>{B(s.currentTarget),p(n)},j=()=>{B(null),p(null)},ce=()=>{u.push("/tasks/new")},de=()=>{r&&u.push(`/tasks/${r.id}/view`),j()},he=()=>{r&&u.push(`/tasks/${r.id}/edit`),j()},ue=()=>{f(!0),j()},xe=()=>{r&&u.push(`/tasks/${r.id}/duplicate`),f(!1),p(null)},F=()=>{f(!1),p(null)},pe=()=>{if(r){const n=S().filter(o=>o.id!==r.id);localStorage.setItem("archivedTasks",JSON.stringify(n)),y(n)}j()},ge=()=>{console.log("Delete task clicked for:",r==null?void 0:r.id,r==null?void 0:r.title),k(!0),j()},je=()=>{if(r){console.log("Deleting task:",r.id,r.title);const s=localStorage.getItem("tasks"),n=localStorage.getItem("archivedTasks");let o=[],b=[];if(s)try{o=JSON.parse(s).filter(g=>{const A=typeof g.id=="string"?parseInt(g.id):g.id,I=typeof r.id=="string"?parseInt(r.id):r.id;return A!==I}),localStorage.setItem("tasks",JSON.stringify(o)),console.log("Updated tasks:",o.length)}catch(m){console.error("Error parsing tasks data:",m)}if(n)try{b=JSON.parse(n).filter(g=>{const A=typeof g.id=="string"?parseInt(g.id):g.id,I=typeof r.id=="string"?parseInt(r.id):r.id;return A!==I}),localStorage.setItem("archivedTasks",JSON.stringify(b)),console.log("Updated archived:",b.length)}catch(m){console.error("Error parsing archived data:",m)}const G=[...o,...b];console.log("Remaining tasks after delete:",G.length),y(G)}k(!1),p(null)},me=s=>{N(s.currentTarget)},ve=()=>{N(null)},fe=s=>{T(n=>({...n,[s]:!n[s]}))},R=()=>{k(!1),p(null)},ye=Math.ceil(J.length/C),$=(E-1)*C,be=$+C,De=J.slice($,be);return e.jsxs(Te,{maxWidth:"xl",children:[e.jsxs(x,{sx:{mb:3},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(a,{variant:"h4",sx:{fontWeight:600},children:"Tasks"}),e.jsx(h,{variant:"contained",onClick:ce,children:"Add Tasks"})]}),e.jsxs(Se,{value:K,onChange:le,sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{textTransform:"none",fontWeight:500},"& .Mui-selected":{color:"primary.main",fontWeight:600},"& .MuiTabs-indicator":{bgcolor:"primary.main"}},children:[e.jsx(D,{label:"Manage Tasks"}),e.jsx(D,{label:"Manage Auto-tasks"}),e.jsx(D,{label:"Checklist Templates"}),e.jsx(D,{label:"Archive"})]})]}),e.jsx(w,{sx:{p:2,mb:3},children:e.jsxs(v,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(v,{size:{xs:12,sm:6,md:3},children:e.jsxs(M,{fullWidth:!0,size:"small",children:[e.jsx(z,{children:"Listing"}),e.jsxs(P,{value:se,label:"Listing",onChange:s=>te(s.target.value),children:[e.jsx(l,{value:"",children:"All Listings"}),e.jsx(l,{value:"old-villa",children:"Old Villa"}),e.jsx(l,{value:"old-apartment",children:"Old Apartment"}),e.jsx(l,{value:"old-property",children:"Old Property"})]})]})}),e.jsx(v,{size:{xs:12,sm:6,md:3},children:e.jsxs(M,{fullWidth:!0,size:"small",children:[e.jsx(z,{children:"Channel"}),e.jsxs(P,{value:ie,label:"Channel",onChange:s=>ne(s.target.value),children:[e.jsx(l,{value:"",children:"All Channels"}),e.jsx(l,{value:"airbnb",children:"Airbnb"}),e.jsx(l,{value:"booking",children:"Booking.com"}),e.jsx(l,{value:"direct",children:"Direct"})]})]})}),e.jsx(v,{size:{xs:12,sm:6,md:3},children:e.jsxs(M,{fullWidth:!0,size:"small",children:[e.jsx(z,{children:"Assignee"}),e.jsxs(P,{value:re,label:"Assignee",onChange:s=>ae(s.target.value),children:[e.jsx(l,{value:"",children:"All Assignees"}),e.jsx(l,{value:"john",children:"John Doe"}),e.jsx(l,{value:"mike",children:"Mike Johnson"}),e.jsx(l,{value:"tom",children:"Tom Brown"})]})]})}),e.jsx(v,{size:{xs:12,sm:6,md:3},children:e.jsx(h,{variant:"outlined",startIcon:e.jsx(d,{icon:"eva:more-horizontal-fill"}),fullWidth:!0,children:"More Filter"})})]})}),e.jsxs(w,{sx:{mb:3},children:[e.jsxs(x,{sx:{p:2,borderBottom:1,borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(a,{variant:"h6",children:"Tasks Table"}),e.jsx(h,{variant:"outlined",size:"small",startIcon:e.jsx(d,{icon:"eva:settings-fill"}),onClick:me,children:"Column Settings"})]}),e.jsx(Ae,{children:e.jsxs(Ie,{children:[e.jsx(we,{children:e.jsxs(U,{children:[i.task&&e.jsx(t,{children:"Task"}),i.description&&e.jsx(t,{children:"Description"}),i.status&&e.jsx(t,{children:"Status"}),i.priority&&e.jsx(t,{children:"Priority"}),i.assignee&&e.jsx(t,{children:"Assignee"}),i.supervisor&&e.jsx(t,{children:"Supervisor"}),i.group&&e.jsx(t,{children:"Group"}),i.startDate&&e.jsx(t,{children:"Start Date"}),i.endDate&&e.jsx(t,{children:"End Date"}),i.category&&e.jsx(t,{children:"Category"}),i.listing&&e.jsx(t,{children:"Listing"}),i.channel&&e.jsx(t,{children:"Channel"}),i.reservation&&e.jsx(t,{children:"Reservation"}),i.cost&&e.jsx(t,{children:"Cost"}),i.archivedDate&&e.jsx(t,{children:"Archived Date"}),e.jsx(t,{align:"center",children:"Actions"})]})}),e.jsx(Oe,{children:De.map(s=>e.jsxs(U,{children:[i.task&&e.jsx(t,{children:e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:s.title||"Untitled Task"})}),i.description&&e.jsx(t,{children:e.jsx(a,{variant:"body2",color:"text.secondary",children:s.description||"-"})}),i.status&&e.jsx(t,{children:e.jsx(H,{label:s.status||"Pending",size:"small",color:"default"})}),i.priority&&e.jsx(t,{children:e.jsx(H,{label:s.priority||"Medium",size:"small",color:s.priority==="High"?"error":s.priority==="Medium"?"warning":"success"})}),i.assignee&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.assignee||"-"})}),i.supervisor&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.supervisor||"-"})}),i.group&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.group||"-"})}),i.startDate&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.startDate||"-"})}),i.endDate&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.endDate||"-"})}),i.category&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.category||"-"})}),i.listing&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.listing||"-"})}),i.channel&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.channel||"-"})}),i.reservation&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.reservation||"-"})}),i.cost&&e.jsx(t,{children:e.jsx(a,{variant:"body2",children:s.cost?`$${s.cost}`:"-"})}),i.archivedDate&&e.jsx(t,{children:e.jsx(a,{variant:"body2",color:"text.secondary",children:s.archivedDate||"-"})}),e.jsx(t,{align:"center",children:e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(O,{size:"small",onClick:()=>u.push(`/tasks/${s.id}/view`),children:e.jsx(d,{icon:"eva:eye-fill",width:16})}),e.jsx(O,{size:"small",onClick:()=>{p(s),f(!0)},children:e.jsx(d,{icon:"eva:copy-fill",width:16})}),e.jsx(O,{size:"small",onClick:n=>oe(n,s),children:e.jsx(d,{icon:"eva:more-vertical-fill",width:16})})]})})]},s.id))})]})})]}),e.jsx(w,{sx:{p:2},children:e.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Show 50 per page"}),e.jsx(Me,{count:ye,page:E,onChange:(s,n)=>X(n),color:"primary"})]})}),e.jsxs(ze,{anchorEl:L,open:!!L,onClose:j,children:[e.jsxs(l,{onClick:de,children:[e.jsx(d,{icon:"eva:eye-fill",sx:{mr:1}}),"View Details"]}),e.jsxs(l,{onClick:he,children:[e.jsx(d,{icon:"eva:edit-fill",sx:{mr:1}}),"Edit"]}),e.jsxs(l,{onClick:ue,children:[e.jsx(d,{icon:"eva:copy-fill",sx:{mr:1}}),"Duplicate"]}),e.jsxs(l,{onClick:pe,children:[e.jsx(d,{icon:"eva:refresh-fill",sx:{mr:1}}),"Restore"]}),e.jsxs(l,{onClick:ge,sx:{color:"error.main"},children:[e.jsx(d,{icon:"eva:trash-2-fill",sx:{mr:1}}),"Delete Permanently"]})]}),e.jsxs(V,{open:ee,onClose:F,children:[e.jsx(Y,{children:"Duplicate?"}),e.jsx(_,{children:e.jsx(a,{children:'Are you sure you want to duplicate this task? This will create a copy with "(Copy)" added to the title.'})}),e.jsxs(q,{children:[e.jsx(h,{onClick:F,children:"No"}),e.jsx(h,{onClick:xe,variant:"contained",children:"Yes"})]})]}),e.jsxs(V,{open:Z,onClose:R,children:[e.jsx(Y,{children:"Delete?"}),e.jsx(_,{children:e.jsx(a,{children:"Are you sure you want to permanently delete this task? This action cannot be undone."})}),e.jsxs(q,{children:[e.jsx(h,{onClick:R,children:"No"}),e.jsx(h,{onClick:je,color:"error",variant:"contained",children:"Yes"})]})]}),e.jsx(ke,{open:!!W,anchorEl:W,onClose:ve,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(x,{sx:{p:2,minWidth:250},children:[e.jsx(a,{variant:"h6",sx:{mb:2},children:"Show/Hide Columns"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Select which columns to display in the table"}),e.jsx(x,{sx:{display:"flex",flexDirection:"column",gap:1,maxHeight:300,overflowY:"auto"},children:Object.entries(i).map(([s,n])=>{const o={task:"Task Title",description:"Description",status:"Status",priority:"Priority",assignee:"Assignee",supervisor:"Supervisor",group:"Group",startDate:"Start Date",endDate:"End Date",category:"Category",listing:"Listing",channel:"Channel",reservation:"Reservation",cost:"Cost",archivedDate:"Archived Date"};return e.jsx(Pe,{control:e.jsx(Ee,{checked:n,onChange:()=>fe(s),size:"small"}),label:o[s]||s,sx:{"& .MuiFormControlLabel-label":{fontSize:"0.875rem"}}},s)})}),e.jsxs(x,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsx(h,{size:"small",onClick:()=>{T({task:!0,description:!0,status:!0,priority:!0,assignee:!0,supervisor:!0,group:!0,startDate:!0,endDate:!0,category:!0,listing:!0,channel:!0,reservation:!0,cost:!0,archivedDate:!0})},children:"Show All"}),e.jsx(h,{size:"small",onClick:()=>{T({task:!0,description:!1,status:!0,priority:!0,assignee:!0,supervisor:!1,group:!1,startDate:!1,endDate:!1,category:!1,listing:!0,channel:!0,reservation:!1,cost:!1,archivedDate:!1})},sx:{ml:1},children:"Show Essential"})]})]})})]})}export{Ze as ArchiveView};
