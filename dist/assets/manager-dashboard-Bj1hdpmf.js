import{af as Y,H as K,bk as q,bn as V,r as f,j as e,B as n,T as s,A as h,C as z,a1 as w,F as k,O as y,I as B}from"./index-DlK49mD9.js";import{D as X}from"./content-BncdO-AK.js";import{G as a}from"./Grid-CFPLP85A.js";import{C as o}from"./Card-C2DhIU3E.js";import{C as d}from"./CardContent-CO_bIGDJ.js";import{S as x}from"./Stack-YrnnkFoz.js";import{U as D}from"./users-4d2Tl7H_.js";import{B as U}from"./building-2-jpVZZJ4u.js";import{M as $}from"./map-pin-B8KcPI2X.js";import{D as Z}from"./dollar-sign-CGxlPLOX.js";import{C as u}from"./CardHeader-Gq3jQEdX.js";import{C as _}from"./chart-column-Da09pY0C.js";import{S as ee}from"./star-CHoEBdVF.js";import{T as se}from"./target-BG0xf5Rt.js";import{T as ie}from"./TextField-DGQVylbQ.js";import"./Select-hkki-_gR.js";import"./Menu-Cd2TK2zY.js";import"./InputLabel-vBrrCZYs.js";import"./FormControl-DsPW8NaL.js";function we(){const t=Y(),{user:c}=K(),{getAllWorkersPerformance:Q}=q(),{addRating:M}=V(),[C,E]=f.useState({}),[P,O]=f.useState({}),[I,F]=f.useState([]),[A,G]=f.useState([]),[S,L]=f.useState([]),W=(i,j,r)=>{E(p=>({...p,[i]:r})),c&&M({workerId:i,workerName:j,ratedBy:c.id,ratedByName:c.name,rating:r,feedback:P[i]})},H=(i,j,r)=>{O(p=>({...p,[i]:j})),c&&C[i]&&M({workerId:i,workerName:r,ratedBy:c.id,ratedByName:c.name,rating:C[i],feedback:j})};f.useEffect(()=>{if(c!=null&&c.assignedUsers){const j=JSON.parse(localStorage.getItem("createdUsers")||"[]").filter(g=>{var m;return(m=c.assignedUsers)==null?void 0:m.includes(g.id)});F(j);const r=JSON.parse(localStorage.getItem("clients")||"[]"),p=[{id:"305034",name:"La Dimora Del Cavaliere",location:"Anguillara Sabazia, Italy",clientId:"client1"},{id:"305035",name:"Navigli",location:"Milano, Italy",clientId:"client1"},{id:"305225",name:"Polacchi42",location:"Roma, Italy",clientId:"client2"},{id:"305421",name:"Superattico - Via Del Corso 43",location:"Roma, Italy",clientId:"client2"},{id:"306532",name:"Montecatini Terme",location:"Montecatini Terme, Italy",clientId:"client3"},{id:"306533",name:"Tuscany Villa",location:"Florence, Italy",clientId:"client3"},{id:"306534",name:"Coastal Retreat",location:"Amalfi, Italy",clientId:"client4"}],v=new Set;j.forEach(g=>{var m;(m=g.assignedClients)==null||m.forEach(R=>v.add(R))});const b=r.filter(g=>v.has(g.id));G(b);const l=new Set;j.forEach(g=>{var m;(m=g.assignedProperties)==null||m.forEach(R=>l.add(R))});const J=p.filter(g=>l.has(g.id));L(J)}},[c]);const T=i=>{switch(i){case"active":return"success";case"inactive":return"warning";case"suspended":return"error";default:return"default"}},N=i=>{switch(i){case"active":return"Active";case"inactive":return"Inactive";case"suspended":return"Suspended";default:return"Active"}};return e.jsxs(X,{maxWidth:"xl",children:[e.jsxs(n,{sx:{mb:3},children:[e.jsx(s,{variant:"h4",gutterBottom:!0,children:"Manager Dashboard"}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["Welcome back, ",c==null?void 0:c.name,"! Here's a comprehensive overview of your team, clients, and business performance."]})]}),e.jsxs(a,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(a,{size:{xs:12,sm:6,md:3},children:e.jsx(o,{children:e.jsx(d,{children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{bgcolor:"primary.main"},children:e.jsx(D,{size:24})}),e.jsxs(n,{children:[e.jsx(s,{variant:"h4",children:I.length}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Team Members"})]})]})})})}),e.jsx(a,{size:{xs:12,sm:6,md:3},children:e.jsx(o,{children:e.jsx(d,{children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{bgcolor:"secondary.main"},children:e.jsx(U,{size:24})}),e.jsxs(n,{children:[e.jsx(s,{variant:"h4",children:A.length}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Active Clients"})]})]})})})}),e.jsx(a,{size:{xs:12,sm:6,md:3},children:e.jsx(o,{children:e.jsx(d,{children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{bgcolor:"info.main"},children:e.jsx($,{size:24})}),e.jsxs(n,{children:[e.jsx(s,{variant:"h4",children:S.length}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Properties"})]})]})})})}),e.jsx(a,{size:{xs:12,sm:6,md:3},children:e.jsx(o,{children:e.jsx(d,{children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(h,{sx:{bgcolor:"success.main"},children:e.jsx(Z,{size:24})}),e.jsxs(n,{children:[e.jsx(s,{variant:"h4",children:"$2.4M"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Revenue"})]})]})})})})]}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{size:{xs:12,md:6},children:e.jsxs(o,{children:[e.jsx(u,{title:"Team Overview"}),e.jsx(d,{children:I.length===0?e.jsx(s,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No team members assigned yet"}):e.jsx(x,{spacing:2,children:I.map(i=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:i.avatar?"transparent":"primary.main",backgroundImage:i.avatar?`url(${i.avatar})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:!i.avatar&&i.name.charAt(0).toUpperCase()}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(s,{variant:"subtitle2",children:i.name}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[i.email," • ",i.role]})]}),e.jsx(z,{label:N(i.status),color:T(i.status),size:"small"})]},i.id))})})]})}),e.jsx(a,{size:{xs:12,md:6},children:e.jsxs(o,{children:[e.jsx(u,{title:"Client Portfolio"}),e.jsx(d,{children:A.length===0?e.jsx(s,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No clients in portfolio yet"}):e.jsx(x,{spacing:2,children:A.map(i=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"secondary.main"},children:i.name.charAt(0).toUpperCase()}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(s,{variant:"subtitle2",children:i.name}),e.jsx(s,{variant:"caption",color:"text.secondary",children:i.email})]}),e.jsx(z,{label:N(i.status),color:T(i.status),size:"small"})]},i.id))})})]})}),e.jsx(a,{size:{xs:12},children:e.jsxs(o,{children:[e.jsx(u,{title:"Properties Management"}),e.jsx(d,{children:S.length===0?e.jsx(s,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No properties managed yet"}):e.jsx(a,{container:!0,spacing:2,children:S.map(i=>e.jsx(a,{size:{xs:12,sm:6,md:4},children:e.jsx(o,{variant:"outlined",children:e.jsxs(d,{children:[e.jsxs(x,{direction:"row",alignItems:"center",spacing:2,sx:{mb:1},children:[e.jsx($,{size:16,color:"#666"}),e.jsx(s,{variant:"subtitle2",sx:{flex:1},children:i.name})]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:i.location}),e.jsxs(s,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["ID: ",i.id]})]})})},i.id))})})]})}),e.jsx(a,{size:{xs:12,md:6},children:e.jsxs(o,{children:[e.jsx(u,{title:"Business Analytics"}),e.jsx(d,{children:e.jsxs(x,{spacing:3,children:[e.jsxs(n,{children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(s,{variant:"body2",children:"Revenue Growth"}),e.jsx(s,{variant:"body2",sx:{fontWeight:600},children:"+12.5%"})]}),e.jsx(w,{variant:"determinate",value:75,sx:{height:8,borderRadius:4}})]}),e.jsxs(n,{children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(s,{variant:"body2",children:"Client Retention"}),e.jsx(s,{variant:"body2",sx:{fontWeight:600},children:"96%"})]}),e.jsx(w,{variant:"determinate",value:96,sx:{height:8,borderRadius:4}})]}),e.jsxs(n,{children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(s,{variant:"body2",children:"Property Occupancy"}),e.jsx(s,{variant:"body2",sx:{fontWeight:600},children:"89%"})]}),e.jsx(w,{variant:"determinate",value:89,sx:{height:8,borderRadius:4}})]}),e.jsxs(n,{children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[e.jsx(s,{variant:"body2",children:"Team Productivity"}),e.jsx(s,{variant:"body2",sx:{fontWeight:600},children:"94%"})]}),e.jsx(w,{variant:"determinate",value:94,sx:{height:8,borderRadius:4}})]})]})})]})}),e.jsx(a,{size:{xs:12,md:6},children:e.jsxs(o,{children:[e.jsx(u,{title:"Key Performance Indicators"}),e.jsx(d,{children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{size:{xs:6},children:e.jsxs(n,{sx:{textAlign:"center",p:2},children:[e.jsx(s,{variant:"h4",color:"primary.main",children:"98%"}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Response Rate"})]})}),e.jsx(a,{size:{xs:6},children:e.jsxs(n,{sx:{textAlign:"center",p:2},children:[e.jsx(s,{variant:"h4",color:"success.main",children:"4.8"}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Avg Rating"})]})}),e.jsx(a,{size:{xs:6},children:e.jsxs(n,{sx:{textAlign:"center",p:2},children:[e.jsx(s,{variant:"h4",color:"info.main",children:"156"}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Tasks Completed"})]})}),e.jsx(a,{size:{xs:6},children:e.jsxs(n,{sx:{textAlign:"center",p:2},children:[e.jsx(s,{variant:"h4",color:"warning.main",children:"$45K"}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Monthly Revenue"})]})})]})})]})}),e.jsx(a,{size:{xs:12},children:e.jsxs(o,{children:[e.jsx(u,{title:"Recent Activity & Updates"}),e.jsx(d,{children:e.jsxs(x,{spacing:2,children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"success.main",width:32,height:32},children:e.jsx(_,{size:16})}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(s,{variant:"body2",children:"Monthly revenue report generated - $45,000"}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"2 hours ago"})]})]}),e.jsx(k,{}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"info.main",width:32,height:32},children:e.jsx(D,{size:16})}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(s,{variant:"body2",children:"New team member onboarded - Sarah Johnson"}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"1 day ago"})]})]}),e.jsx(k,{}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"warning.main",width:32,height:32},children:e.jsx(U,{size:16})}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(s,{variant:"body2",children:"New client contract signed - Premium Properties"}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"3 days ago"})]})]}),e.jsx(k,{}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{bgcolor:"primary.main",width:32,height:32},children:e.jsx(ee,{size:16})}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(s,{variant:"body2",children:"Client satisfaction survey completed - 4.8/5 rating"}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"1 week ago"})]})]})]})})]})}),e.jsx(a,{size:{xs:12},children:e.jsxs(o,{sx:{borderRadius:2,overflow:"hidden"},children:[e.jsx(u,{title:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(se,{size:20,color:t.palette.primary.main}),e.jsx(s,{variant:"h6",sx:{fontWeight:600},children:"Performance Overview & Rating"})]}),subheader:"Rate your team members and provide feedback"}),e.jsx(d,{sx:{p:3},children:e.jsx(a,{container:!0,spacing:3,children:I.map(i=>{const r=Q().find(l=>l.workerName===i.name);if(!r)return e.jsx(a,{size:{xs:12,md:6},children:e.jsx(o,{sx:{border:`1px solid ${y(t.palette.grey[500],.2)}`,bgcolor:"background.paper"},children:e.jsxs(d,{sx:{p:3},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{width:48,height:48,bgcolor:t.palette.primary.main,fontWeight:600},children:i.name.charAt(0)}),e.jsxs(n,{children:[e.jsx(s,{variant:"subtitle1",sx:{fontWeight:600},children:i.name}),e.jsx(s,{variant:"caption",color:"text.secondary",children:i.email})]})]}),e.jsx(z,{label:"No Data Yet",size:"small",color:"default",sx:{fontWeight:600}})]}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No performance data available"}),e.jsxs(n,{sx:{mt:2,pt:2,borderTop:`1px solid ${y(t.palette.grey[500],.2)}`},children:[e.jsx(s,{variant:"caption",sx:{fontWeight:600,mb:1,display:"block"},children:"Your Rating"}),e.jsx(n,{sx:{display:"flex",gap:1},children:[1,2,3,4,5].map(l=>e.jsx(B,{size:"small",onClick:()=>W(i.name,i.name,l),sx:{color:C[i.name]>=l?t.palette.warning.main:t.palette.grey[400],"&:hover":{color:t.palette.warning.main}},children:"★"},l))})]})]})})},i.id);const p=r.averageQualityScore<70,v=r.averageQualityScore>=70&&r.averageQualityScore<80,b=r.averageQualityScore>=80;return e.jsx(a,{size:{xs:12,md:6},children:e.jsx(o,{sx:{border:p?`2px solid ${t.palette.error.main}`:`1px solid ${y(t.palette.grey[500],.2)}`,bgcolor:p?y(t.palette.error.main,.05):"background.paper"},children:e.jsxs(d,{sx:{p:3},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(h,{sx:{width:48,height:48,bgcolor:t.palette.primary.main,fontWeight:600},children:i.name.charAt(0)}),e.jsxs(n,{children:[e.jsx(s,{variant:"subtitle1",sx:{fontWeight:600},children:i.name}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[r.totalMessages," messages • Avg: ",Math.round(r.averageQualityScore),"%"]})]})]}),e.jsx(z,{label:b?"Excellent":v?"Good":"Needs Improvement",size:"small",color:b?"success":v?"warning":"error",sx:{fontWeight:600}})]}),e.jsxs(n,{sx:{mb:2},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Quality Score"}),e.jsxs(s,{variant:"caption",sx:{fontWeight:600},children:[Math.round(r.averageQualityScore),"%"]})]}),e.jsx(w,{variant:"determinate",value:r.averageQualityScore,sx:{height:8,borderRadius:2,bgcolor:y(t.palette.grey[300],.3),"& .MuiLinearProgress-bar":{bgcolor:b?t.palette.success.main:v?t.palette.warning.main:t.palette.error.main}}})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Response Time: ",Math.round(r.averageResponseTime/(1e3*60)),"m"]}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Messages: ",r.totalMessages]})]}),e.jsxs(n,{sx:{mt:2,pt:2,borderTop:`1px solid ${y(t.palette.grey[500],.2)}`},children:[e.jsx(s,{variant:"caption",sx:{fontWeight:600,mb:1,display:"block"},children:"Your Rating"}),e.jsx(n,{sx:{display:"flex",gap:1},children:[1,2,3,4,5].map(l=>e.jsx(B,{size:"small",onClick:()=>W(r.workerId,r.workerName,l),sx:{color:C[r.workerId]>=l?t.palette.warning.main:t.palette.grey[400],"&:hover":{color:t.palette.warning.main}},children:"★"},l))})]}),p&&e.jsxs(n,{sx:{mt:2,pt:2,borderTop:`1px solid ${y(t.palette.error.main,.3)}`},children:[e.jsx(s,{variant:"caption",sx:{fontWeight:600,mb:1,display:"block",color:"error.main"},children:"Improvement Notes (Required)"}),e.jsx(n,{sx:{width:"100%"},children:e.jsx(ie,{fullWidth:!0,multiline:!0,rows:2,placeholder:"Add notes for improvement...",size:"small",value:P[r.workerId]||"",onChange:l=>H(r.workerId,l.target.value,r.workerName),sx:{"& .MuiOutlinedInput-root":{fontSize:"0.875rem"}}})})]})]})})},i.id)})})})]})})]})]})}export{we as ManagerDashboardPage};
