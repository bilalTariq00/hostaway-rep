import{r as t,j as e,B as r,T as s,I as S,g as z,a as k,J as E}from"./index-DlK49mD9.js";import{D as B}from"./content-BncdO-AK.js";import{S as P,u as A,W as O,M as F}from"./message-components-BEvfzTAf.js";import{P as U}from"./paperclip-BL7KT8Nj.js";import{T as D}from"./TextField-DGQVylbQ.js";import{S as M}from"./send-DaTpFara.js";import{W as H}from"./wifi-6vt-lql1.js";import{R as K}from"./refresh-cw-BjMn4P5P.js";import{C}from"./Card-C2DhIU3E.js";import{C as v}from"./CardContent-CO_bIGDJ.js";import"./Select-hkki-_gR.js";import"./Menu-Cd2TK2zY.js";import"./InputLabel-vBrrCZYs.js";import"./FormControl-DsPW8NaL.js";function V({onSendMessage:a,receiverId:u,disabled:l=!1,placeholder:p="Type a message...",maxLength:i=1e3,showTypingIndicator:x=!0,onTyping:o}){const[c,g]=t.useState(""),[f,m]=t.useState(!1),b=t.useRef(null),d=t.useRef(null),I=t.useCallback(n=>{g(n),!(!x||!o)&&(d.current&&clearTimeout(d.current),n.length>0&&!f&&(m(!0),o(!0)),d.current=setTimeout(()=>{m(!1),o(!1)},1e3))},[f,o,x]),j=t.useCallback(()=>{const n=c.trim();!n||l||(a(n,u),g(""),d.current&&clearTimeout(d.current),m(!1),o==null||o(!1))},[c,l,a,u,o]),R=t.useCallback(n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),j())},[j]),h=t.useCallback(n=>{const T=n.clipboardData.getData("text");T.length>i&&(n.preventDefault(),g(T.substring(0,i)))},[i]);t.useEffect(()=>{b.current&&b.current.focus()},[]),t.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]);const y=c.trim().length>0&&!l,w=c.length,W=w>i*.8;return e.jsxs(r,{sx:{p:2,borderTop:"1px solid",borderColor:"divider",backgroundColor:"background.paper"},children:[W&&e.jsxs(s,{variant:"caption",sx:{display:"block",mb:1,color:w>=i?"error.main":"warning.main",textAlign:"right"},children:[w,"/",i]}),e.jsxs(r,{sx:{display:"flex",alignItems:"flex-end",gap:1},children:[e.jsx(S,{size:"small",disabled:l,sx:{backgroundColor:"grey.100","&:hover":{backgroundColor:"grey.200"},"&:disabled":{backgroundColor:"grey.50"}},children:e.jsx(U,{size:16})}),e.jsx(S,{size:"small",disabled:l,sx:{backgroundColor:"grey.100","&:hover":{backgroundColor:"grey.200"},"&:disabled":{backgroundColor:"grey.50"}},children:e.jsx(P,{size:16})}),e.jsx(D,{ref:b,fullWidth:!0,multiline:!0,maxRows:4,value:c,onChange:n=>I(n.target.value),onKeyPress:R,onPaste:h,disabled:l,placeholder:p,inputProps:{maxLength:i},sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"background.paper","&:hover":{backgroundColor:"grey.50"},"&.Mui-focused":{backgroundColor:"background.paper"}},"& .MuiInputBase-input":{fontSize:"0.875rem",lineHeight:1.5}},InputProps:{endAdornment:e.jsx(z,{position:"end",children:e.jsx(k,{variant:"contained",size:"small",onClick:j,disabled:!y,sx:{minWidth:"auto",width:36,height:36,borderRadius:"50%",backgroundColor:y?"primary.main":"grey.300","&:hover":{backgroundColor:y?"primary.dark":"grey.400"},"&:disabled":{backgroundColor:"grey.300"}},children:e.jsx(M,{size:16})})})}})]}),l&&e.jsx(s,{variant:"caption",sx:{display:"block",mt:1,color:"error.main",textAlign:"center"},children:"Disconnected - Messages will be queued"})]})}function q({receiverId:a,conversationId:u,className:l,sx:p}){const{messages:i,isConnected:x,error:o,sendMessage:c,clearMessages:g,retryConnection:f}=A(u),m=t.useRef(null),[b,d]=t.useState(!1),I=()=>{var h;(h=m.current)==null||h.scrollIntoView({behavior:"smooth"})};t.useEffect(()=>{I()},[i]);const j=h=>{d(h)},R=(h,y)=>{c(h,y)};return e.jsxs(r,{className:l,sx:{display:"flex",flexDirection:"column",height:"100%",backgroundColor:"background.default",borderRadius:2,overflow:"hidden",border:"1px solid",borderColor:"divider",...p},children:[e.jsxs(r,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider",backgroundColor:"background.paper",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(s,{variant:"h6",sx:{fontWeight:600},children:["Chat with ",a]}),e.jsx(r,{sx:{display:"flex",alignItems:"center",gap:1},children:x?e.jsxs(e.Fragment,{children:[e.jsx(H,{size:16,color:"#4caf50"}),e.jsx(s,{variant:"caption",sx:{color:"success.main"},children:"Connected"})]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:16,color:"#f44336"}),e.jsx(s,{variant:"caption",sx:{color:"error.main"},children:"Disconnected"})]})}),b&&e.jsxs(s,{variant:"caption",sx:{color:"primary.main",fontStyle:"italic"},children:[a," is typing..."]})]}),e.jsxs(r,{sx:{display:"flex",gap:1},children:[e.jsx(S,{size:"small",onClick:f,disabled:x,sx:{backgroundColor:"grey.100","&:hover":{backgroundColor:"grey.200"}},children:e.jsx(K,{size:16})}),e.jsx(k,{size:"small",variant:"outlined",onClick:g,sx:{minWidth:"auto",px:2},children:"Clear"})]})]}),o&&e.jsx(E,{severity:"error",sx:{m:2,borderRadius:2},action:e.jsx(k,{color:"inherit",size:"small",onClick:f,children:"Retry"}),children:o}),e.jsxs(r,{sx:{flex:1,overflow:"hidden",position:"relative"},children:[e.jsx(F,{messages:i,showResponseTime:!0,showAvatar:!0}),e.jsx("div",{ref:m})]}),e.jsx(V,{onSendMessage:R,receiverId:a,disabled:!x,placeholder:`Message ${a}...`,maxLength:1e3,showTypingIndicator:!0,onTyping:j})]})}function ne(){const[a,u]=t.useState("user-123"),[l,p]=t.useState("conv-demo"),[i,x]=t.useState(!1),o=()=>{a.trim()&&x(!0)};return e.jsx(B,{children:e.jsxs(r,{sx:{p:3},children:[e.jsx(s,{variant:"h4",sx:{mb:3,fontWeight:600},children:"Real-time Chat Demo"}),e.jsx(s,{variant:"body1",sx:{mb:4,color:"text.secondary"},children:"Experience high-performance real-time messaging with response time calculation. Messages are sent instantly with optimistic UI updates for minimal latency."}),e.jsx(C,{sx:{mb:3},children:e.jsxs(v,{children:[e.jsx(s,{variant:"h6",sx:{mb:2},children:"Chat Configuration"}),e.jsxs(r,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(D,{label:"Receiver ID",value:a,onChange:c=>u(c.target.value),placeholder:"Enter receiver ID",sx:{flex:1}}),e.jsx(D,{label:"Conversation ID",value:l,onChange:c=>p(c.target.value),placeholder:"Enter conversation ID",sx:{flex:1}})]}),e.jsx(k,{variant:"contained",onClick:o,startIcon:e.jsx(M,{size:20}),disabled:!a.trim(),sx:{borderRadius:2},children:"Start Chat"})]})}),e.jsx(C,{sx:{mb:3},children:e.jsxs(v,{children:[e.jsx(s,{variant:"h6",sx:{mb:2},children:"Features"}),e.jsxs(r,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:2},children:[e.jsxs(r,{children:[e.jsx(s,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"âš¡ Low Latency"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Optimistic UI updates for instant message display"})]}),e.jsxs(r,{children:[e.jsx(s,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"ğŸ“Š Response Time"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Automatic calculation and display of response times"})]}),e.jsxs(r,{children:[e.jsx(s,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"ğŸ”„ Real-time Sync"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Socket.IO powered real-time message delivery"})]}),e.jsxs(r,{children:[e.jsx(s,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"ğŸ“± Typing Indicators"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Live typing status with debounced updates"})]}),e.jsxs(r,{children:[e.jsx(s,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"ğŸ›¡ï¸ Error Handling"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Connection status monitoring and retry logic"})]}),e.jsxs(r,{children:[e.jsx(s,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"ğŸ¨ Modern UI"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Beautiful Material-UI components with animations"})]})]})]})}),i&&e.jsx(C,{children:e.jsx(v,{sx:{p:0},children:e.jsx(r,{sx:{height:"600px"},children:e.jsx(q,{receiverId:a,conversationId:l,sx:{height:"100%"}})})})}),!i&&e.jsx(C,{children:e.jsxs(v,{children:[e.jsx(s,{variant:"h6",sx:{mb:2},children:"How to Test"}),e.jsxs(r,{component:"ol",sx:{pl:2,m:0},children:[e.jsx(s,{component:"li",variant:"body2",sx:{mb:1},children:"Open this page in multiple browser tabs or devices"}),e.jsx(s,{component:"li",variant:"body2",sx:{mb:1},children:"Use different receiver IDs to simulate different users"}),e.jsx(s,{component:"li",variant:"body2",sx:{mb:1},children:"Send messages and observe response time calculations"}),e.jsx(s,{component:"li",variant:"body2",sx:{mb:1},children:"Test typing indicators by typing in the input field"}),e.jsx(s,{component:"li",variant:"body2",sx:{mb:1},children:"Disconnect/reconnect to test error handling"})]})]})})]})})}export{ne as ChatDemoView};
