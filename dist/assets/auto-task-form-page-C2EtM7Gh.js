import{a3 as F,G,r as T,j as e,B as a,a as h,T as r,e as i,I as C,a5 as E,x as J}from"./index-DlK49mD9.js";import{D as P}from"./content-BncdO-AK.js";import{A as H}from"./arrow-left-oo0y3C6Y.js";import{S as $}from"./save-CQZiseXE.js";import{T as p}from"./TextField-DGQVylbQ.js";import{F as c}from"./FormControl-DsPW8NaL.js";import{S as d}from"./Select-hkki-_gR.js";import{I as u}from"./InputLabel-vBrrCZYs.js";import{P as O}from"./plus-C-Pm_q2r.js";import{S as I}from"./Switch-Bj_iObyt.js";import{I as q}from"./info-LH2MLhPO.js";import{C as Q}from"./Card-C2DhIU3E.js";import{C as X}from"./CardContent-CO_bIGDJ.js";import{C as B}from"./Checkbox-Cws__oH0.js";import{F as W}from"./FormControlLabel-DYCM3_AA.js";import"./Menu-Cd2TK2zY.js";import"./SwitchBase-D6K1hBX3.js";const k=[{id:"305034",name:"La Dimora Del Cavaliere",image:"/assets/images/listing1.jpg"},{id:"305035",name:"Navigli",image:"/assets/images/listing2.jpg"},{id:"305225",name:"Polacchi42",image:"/assets/images/listing3.jpg"},{id:"305421",name:"Superattico - Via Del Corso 43",image:"/assets/images/listing4.jpg"},{id:"306532",name:"Montecatini Terme",image:"/assets/images/listing5.jpg"},{id:"308582",name:"Monteverde - Quattroventi",image:"/assets/images/listing6.jpg"},{id:"310867",name:"La Storta",image:"/assets/images/listing7.jpg"},{id:"317154",name:"[5 Min From Trastevere] Chic Apt",image:"/assets/images/listing8.jpg"},{id:"332386",name:"Via Poggio Tulliano",image:"/assets/images/listing9.jpg"},{id:"363365",name:"Via di Acqua Bullicante 113",image:"/assets/images/listing10.jpg"},{id:"345603",name:"Via Dei Marruccini | San Lorenzo",image:"/assets/images/listing11.jpg"},{id:"363366",name:"Via Matera 23A",image:"/assets/images/listing12.jpg"}];function me(){const{id:f}=F(),L=G(),y=!!f,b=window.location.pathname.includes("/duplicate"),x=(()=>{const s=localStorage.getItem("autoTasks");return s?JSON.parse(s):[]})().find(s=>s.id===parseInt(f||"0")),n=y&&x?{title:x.name||"",event:x.startingEvent||"Check-in",startsAtValue:0,startsAtUnit:"Hours",startsAtTiming:"At",startsAtEvent:x.startingEvent||"Check-in",shouldEndByValue:0,shouldEndByUnit:"Hours",shouldEndByTiming:"At",shouldEndByEvent:"Check-out",description:x.description||"",checklistTemplate:"Checklist template",attachments:[],addAutomaticallyNewListings:!1,active:x.status==="Active",assignee:"Assignee user",supervisor:"Supervisor user",group:"User group",category:"",channel:x.linkedChannel||"Channel",cost:"",costCurrency:"Cost currency",costDescription:"",autoGenerateExpense:!1,createTasksForExistingReservations:!0,selectedListings:[]}:{},[t,A]=T.useState({title:n.title||"",event:n.event||"Check-in",startsAtValue:n.startsAtValue||0,startsAtUnit:n.startsAtUnit||"Hours",startsAtTiming:n.startsAtTiming||"At",startsAtEvent:n.startsAtEvent||"Check-in",shouldEndByValue:n.shouldEndByValue||0,shouldEndByUnit:n.shouldEndByUnit||"Hours",shouldEndByTiming:n.shouldEndByTiming||"At",shouldEndByEvent:n.shouldEndByEvent||"Check-out",description:n.description||"",checklistTemplate:n.checklistTemplate||"Checklist template",attachments:n.attachments||[],addAutomaticallyNewListings:n.addAutomaticallyNewListings||!1,active:n.active||!1,assignee:n.assignee||"Assignee user",supervisor:n.supervisor||"Supervisor user",group:n.group||"User group",category:n.category||"",channel:n.channel||"Channel",cost:n.cost||"",costCurrency:n.costCurrency||"Cost currency",costDescription:n.costDescription||"",autoGenerateExpense:n.autoGenerateExpense||!1,createTasksForExistingReservations:n.createTasksForExistingReservations||!0,selectedListings:n.selectedListings||[]}),[S,w]=T.useState(""),[D,U]=T.useState([]),l=(s,o)=>{A(j=>({...j,[s]:o}))},z=s=>{A(o=>({...o,selectedListings:o.selectedListings.includes(s)?o.selectedListings.filter(j=>j!==s):[...o.selectedListings,s]}))},M=()=>{const s=k.map(o=>o.id);A(o=>({...o,selectedListings:o.selectedListings.length===s.length?[]:s}))},V=()=>{var o,j;console.log("Saving auto-task:",t);const s=JSON.parse(localStorage.getItem("autoTasks")||"[]");if(b){const g={id:Date.now(),name:t.title,startingEvent:t.event,dueBefore:`${t.shouldEndByValue} ${t.shouldEndByUnit.toLowerCase()}`,linkedChannel:t.channel,linkedListing:t.selectedListings.length>0?((o=k.find(v=>v.id===t.selectedListings[0]))==null?void 0:o.name)||"Multiple Listings":"No Listing",status:t.active?"Active":"Inactive",description:t.description},m=[...s,g];localStorage.setItem("autoTasks",JSON.stringify(m)),console.log("Created duplicate auto-task:",g)}else if(y&&f){const g=s.map(m=>{var v;return m.id===parseInt(f)?{...m,name:t.title,startingEvent:t.event,dueBefore:`${t.shouldEndByValue} ${t.shouldEndByUnit.toLowerCase()}`,linkedChannel:t.channel,linkedListing:t.selectedListings.length>0?((v=k.find(R=>R.id===t.selectedListings[0]))==null?void 0:v.name)||"Multiple Listings":"No Listing",status:t.active?"Active":"Inactive",description:t.description}:m});localStorage.setItem("autoTasks",JSON.stringify(g)),console.log("Updated auto-task:",t)}else{const g={id:Date.now(),name:t.title,startingEvent:t.event,dueBefore:`${t.shouldEndByValue} ${t.shouldEndByUnit.toLowerCase()}`,linkedChannel:t.channel,linkedListing:t.selectedListings.length>0?((j=k.find(v=>v.id===t.selectedListings[0]))==null?void 0:j.name)||"Multiple Listings":"No Listing",status:t.active?"Active":"Inactive",description:t.description},m=[...s,g];localStorage.setItem("autoTasks",JSON.stringify(m)),console.log("Created new auto-task:",g)}L("/tasks/manage-auto-tasks")},N=k.filter(s=>s.name.toLowerCase().includes(S.toLowerCase()));return e.jsxs(P,{maxWidth:"xl",children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsx(h,{startIcon:e.jsx(H,{size:16}),onClick:()=>L("/tasks/manage-auto-tasks"),children:"Back to auto-tasks"}),e.jsx(h,{variant:"contained",onClick:V,startIcon:e.jsx($,{size:16}),children:b?"Create Duplicate":y?"Update auto-task":"Save auto-task"})]}),e.jsxs(a,{sx:{display:"flex",gap:3},children:[e.jsxs(a,{sx:{flex:2},children:[e.jsx(p,{fullWidth:!0,label:"Task title",placeholder:"Task title",value:t.title,onChange:s=>l("title",s.target.value),sx:{mb:4},helperText:b?"This will create a new auto-task based on the original":""}),e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Schedule"}),e.jsxs(a,{sx:{mb:3},children:[e.jsx(r,{variant:"body2",sx:{mb:1,fontWeight:500},children:"Event"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(c,{sx:{minWidth:200},children:e.jsxs(d,{value:t.event,onChange:s=>l("event",s.target.value),displayEmpty:!0,children:[e.jsx(i,{value:"Check-in",children:"Check-in"}),e.jsx(i,{value:"Check-out",children:"Check-out"}),e.jsx(i,{value:"Booking Confirmed",children:"Booking Confirmed"}),e.jsx(i,{value:"Issue Reported",children:"Issue Reported"})]})}),e.jsx(C,{size:"small",children:e.jsx(E,{size:16})}),e.jsx(C,{size:"small",children:e.jsx(r,{variant:"body2",children:"▼"})})]})]}),e.jsxs(a,{sx:{mb:3},children:[e.jsx(r,{variant:"body2",sx:{mb:1,fontWeight:500},children:"Starts at"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(p,{type:"number",value:t.startsAtValue,onChange:s=>l("startsAtValue",parseInt(s.target.value)||0),sx:{width:80}}),e.jsx(a,{sx:{display:"flex",gap:.5},children:["Hours","Days"].map(s=>e.jsx(h,{variant:t.startsAtUnit===s?"contained":"outlined",size:"small",onClick:()=>l("startsAtUnit",s),sx:{minWidth:"auto",px:1},children:s},s))}),e.jsx(a,{sx:{display:"flex",gap:.5},children:["Before","At","After"].map(s=>e.jsx(h,{variant:t.startsAtTiming===s?"contained":"outlined",size:"small",onClick:()=>l("startsAtTiming",s),sx:{minWidth:"auto",px:1},children:s},s))}),e.jsx(c,{sx:{minWidth:150},children:e.jsxs(d,{value:t.startsAtEvent,onChange:s=>l("startsAtEvent",s.target.value),displayEmpty:!0,children:[e.jsx(i,{value:"Check-in",children:"Check-in"}),e.jsx(i,{value:"Check-out",children:"Check-out"}),e.jsx(i,{value:"Booking Confirmed",children:"Booking Confirmed"}),e.jsx(i,{value:"Issue Reported",children:"Issue Reported"})]})}),e.jsx(C,{size:"small",children:e.jsx(E,{size:16})}),e.jsx(C,{size:"small",children:e.jsx(r,{variant:"body2",children:"▼"})})]})]}),e.jsxs(a,{sx:{mb:3},children:[e.jsx(r,{variant:"body2",sx:{mb:1,fontWeight:500},children:"Should end by"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(p,{type:"number",value:t.shouldEndByValue,onChange:s=>l("shouldEndByValue",parseInt(s.target.value)||0),sx:{width:80}}),e.jsx(a,{sx:{display:"flex",gap:.5},children:["Hours","Days"].map(s=>e.jsx(h,{variant:t.shouldEndByUnit===s?"contained":"outlined",size:"small",onClick:()=>l("shouldEndByUnit",s),sx:{minWidth:"auto",px:1},children:s},s))}),e.jsx(a,{sx:{display:"flex",gap:.5},children:["Before","At","After"].map(s=>e.jsx(h,{variant:t.shouldEndByTiming===s?"contained":"outlined",size:"small",onClick:()=>l("shouldEndByTiming",s),sx:{minWidth:"auto",px:1},children:s},s))}),e.jsx(c,{sx:{minWidth:150},children:e.jsxs(d,{value:t.shouldEndByEvent,onChange:s=>l("shouldEndByEvent",s.target.value),displayEmpty:!0,children:[e.jsx(i,{value:"Check-in",children:"Check-in"}),e.jsx(i,{value:"Check-out",children:"Check-out"}),e.jsx(i,{value:"Booking Confirmed",children:"Booking Confirmed"}),e.jsx(i,{value:"Issue Reported",children:"Issue Reported"})]})}),e.jsx(C,{size:"small",children:e.jsx(E,{size:16})}),e.jsx(C,{size:"small",children:e.jsx(r,{variant:"body2",children:"▼"})})]})]})]}),e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Details"}),e.jsx(p,{fullWidth:!0,multiline:!0,rows:4,label:"Description",placeholder:"Description",value:t.description,onChange:s=>l("description",s.target.value)})]}),e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Task checklist"}),e.jsxs(c,{fullWidth:!0,children:[e.jsx(u,{children:"Checklist template"}),e.jsxs(d,{value:t.checklistTemplate,label:"Checklist template",onChange:s=>l("checklistTemplate",s.target.value),children:[e.jsx(i,{value:"Checklist template",children:"Checklist template"}),e.jsx(i,{value:"Cleaning Checklist",children:"Cleaning Checklist"}),e.jsx(i,{value:"Maintenance Checklist",children:"Maintenance Checklist"}),e.jsx(i,{value:"Inspection Checklist",children:"Inspection Checklist"})]})]})]}),e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Attachments"}),e.jsx(h,{variant:"text",startIcon:e.jsx(O,{size:16}),children:"ADD ATTACHMENT"})]}),e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Listing"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(I,{checked:t.addAutomaticallyNewListings,onChange:s=>l("addAutomaticallyNewListings",s.target.checked)}),e.jsx(r,{variant:"body2",children:"Add automatically new listings"}),e.jsx(J,{title:"This will automatically add new listings to this auto-task",children:e.jsx(q,{size:16})})]}),e.jsx(p,{fullWidth:!0,placeholder:"Type to search listing...",value:S,onChange:s=>w(s.target.value),sx:{mb:2}}),e.jsxs(c,{fullWidth:!0,sx:{mb:2},children:[e.jsx(u,{children:"Select tags"}),e.jsxs(d,{multiple:!0,value:D,onChange:s=>U(s.target.value),label:"Select tags",children:[e.jsx(i,{value:"luxury",children:"Luxury"}),e.jsx(i,{value:"budget",children:"Budget"}),e.jsx(i,{value:"family",children:"Family"}),e.jsx(i,{value:"business",children:"Business"})]})]}),e.jsx(h,{variant:"contained",onClick:M,sx:{mb:2},children:"Select all"}),e.jsx(a,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:2},children:N.map(s=>e.jsx(Q,{sx:{position:"relative"},children:e.jsx(X,{sx:{p:2},children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(a,{sx:{width:60,height:60,bgcolor:"grey.200",borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(r,{variant:"caption",color:"text.secondary",children:"Image"})}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(r,{variant:"body2",sx:{fontWeight:500},children:s.name}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:["(",s.id,")"]})]}),e.jsx(B,{checked:t.selectedListings.includes(s.id),onChange:()=>z(s.id)})]})})},s.id))})]})]}),e.jsxs(a,{sx:{flex:1},children:[e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Active"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(I,{checked:t.active,onChange:s=>l("active",s.target.checked)}),e.jsx(r,{variant:"body2",children:t.active?"Yes":"No"})]})]}),e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Users"}),e.jsxs(c,{fullWidth:!0,sx:{mb:2},children:[e.jsx(u,{children:"Assignee"}),e.jsxs(d,{value:t.assignee,label:"Assignee",onChange:s=>l("assignee",s.target.value),children:[e.jsx(i,{value:"Assignee user",children:"Assignee user"}),e.jsx(i,{value:"John Doe",children:"John Doe"}),e.jsx(i,{value:"Mike Johnson",children:"Mike Johnson"}),e.jsx(i,{value:"Tom Brown",children:"Tom Brown"})]})]}),e.jsxs(c,{fullWidth:!0,sx:{mb:2},children:[e.jsx(u,{children:"Supervisor"}),e.jsxs(d,{value:t.supervisor,label:"Supervisor",onChange:s=>l("supervisor",s.target.value),children:[e.jsx(i,{value:"Supervisor user",children:"Supervisor user"}),e.jsx(i,{value:"Jane Smith",children:"Jane Smith"}),e.jsx(i,{value:"Sarah Wilson",children:"Sarah Wilson"})]})]}),e.jsxs(c,{fullWidth:!0,children:[e.jsx(u,{children:"Group"}),e.jsxs(d,{value:t.group,label:"Group",onChange:s=>l("group",s.target.value),children:[e.jsx(i,{value:"User group",children:"User group"}),e.jsx(i,{value:"Cleaning Team",children:"Cleaning Team"}),e.jsx(i,{value:"Maintenance Team",children:"Maintenance Team"})]})]})]}),e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Link"}),e.jsxs(c,{fullWidth:!0,sx:{mb:2},children:[e.jsx(u,{children:"Category"}),e.jsxs(d,{value:t.category,label:"Category",onChange:s=>l("category",s.target.value),children:[e.jsx(i,{value:"",children:"Select Category"}),e.jsx(i,{value:"Maintenance",children:"Maintenance"}),e.jsx(i,{value:"Cleaning",children:"Cleaning"}),e.jsx(i,{value:"Inspection",children:"Inspection"}),e.jsx(i,{value:"Guest Service",children:"Guest Service"})]})]}),e.jsxs(c,{fullWidth:!0,children:[e.jsx(u,{children:"Channel"}),e.jsxs(d,{value:t.channel,label:"Channel",onChange:s=>l("channel",s.target.value),children:[e.jsx(i,{value:"Channel",children:"Channel"}),e.jsx(i,{value:"Airbnb",children:"Airbnb"}),e.jsx(i,{value:"Booking.com",children:"Booking.com"}),e.jsx(i,{value:"Direct",children:"Direct"})]})]})]}),e.jsxs(a,{sx:{mb:4},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Cost"}),e.jsx(p,{fullWidth:!0,label:"Cost",placeholder:"Cost",value:t.cost,onChange:s=>l("cost",s.target.value),sx:{mb:2}}),e.jsxs(c,{fullWidth:!0,sx:{mb:2},children:[e.jsx(u,{children:"Cost currency"}),e.jsxs(d,{value:t.costCurrency,label:"Cost currency",onChange:s=>l("costCurrency",s.target.value),children:[e.jsx(i,{value:"Cost currency",children:"Cost currency"}),e.jsx(i,{value:"USD",children:"USD"}),e.jsx(i,{value:"EUR",children:"EUR"}),e.jsx(i,{value:"GBP",children:"GBP"})]})]}),e.jsx(p,{fullWidth:!0,multiline:!0,rows:3,label:"Cost description",placeholder:"Cost description",value:t.costDescription,onChange:s=>l("costDescription",s.target.value),sx:{mb:2}}),e.jsx(W,{control:e.jsx(B,{checked:t.autoGenerateExpense,onChange:s=>l("autoGenerateExpense",s.target.checked)}),label:"Automatically generate an expense when the task is marked as done",sx:{mb:1}}),e.jsx(W,{control:e.jsx(B,{checked:t.createTasksForExistingReservations,onChange:s=>l("createTasksForExistingReservations",s.target.checked)}),label:"Create tasks from this auto-task for existing reservations"})]})]})]})]})}export{me as AutoTaskFormPage};
