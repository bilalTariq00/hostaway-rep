import{D as re,r as i,j as e,B as s,T as o,a as d,e as r,a4 as w,I as le,P as ce,C as de}from"./index-DlK49mD9.js";import{D as he}from"./content-BncdO-AK.js";import{T as xe,a as k}from"./Tabs-CawWx8bN.js";import{D as pe}from"./download-Cf74o_52.js";import{M as ge}from"./Menu-Cd2TK2zY.js";import{T as v}from"./TextField-DGQVylbQ.js";import{F as E}from"./FormControl-DsPW8NaL.js";import{I as V}from"./InputLabel-vBrrCZYs.js";import{S as H}from"./Select-hkki-_gR.js";import{T as ue}from"./TableContainer-1FovwQIv.js";import{T as me,a as be,b as T,c as p,d as ye}from"./TableHead-BbeVJGli.js";import{C as je}from"./chevron-up-Be3A51t0.js";import{C as Ce}from"./chevron-down-CCU2oTw6.js";import{S as fe}from"./settings-BgN3WhmC.js";import{P as ke}from"./Pagination-BTzUsZhy.js";import{S as ve}from"./search-C7TcvOao.js";import{F as Se}from"./FormControlLabel-DYCM3_AA.js";import{C as we}from"./Checkbox-Cws__oH0.js";import{M as Te}from"./minus-CfNPLUE2.js";import{T as ze}from"./trending-down-DZZd7H2P.js";import{T as De}from"./trending-up-Dyf_uQEU.js";import"./KeyboardArrowRight-B0juUeOl.js";import"./LastPage-lp5Gj61X.js";import"./SwitchBase-D6K1hBX3.js";const z=[{id:1,listingName:"La Dimora Del Cavaliere",nightsAvailable:30,nightsBooked:25,ownerStayNights:2,occupancyRate:83.3,occupancyTrend:"up",occupancyChange:5.2,totalCheckin:15},{id:2,listingName:"Navigli",nightsAvailable:28,nightsBooked:20,ownerStayNights:1,occupancyRate:71.4,occupancyTrend:"down",occupancyChange:-3.1,totalCheckin:12},{id:3,listingName:"Polacchi42",nightsAvailable:31,nightsBooked:18,ownerStayNights:3,occupancyRate:58.1,occupancyTrend:"stable",occupancyChange:0,totalCheckin:8},{id:4,listingName:"Superattico - Via Del C...",nightsAvailable:29,nightsBooked:24,ownerStayNights:1,occupancyRate:82.8,occupancyTrend:"up",occupancyChange:8.7,totalCheckin:18}],q=(l,b,y)=>{const j=()=>{switch(b){case"up":return e.jsx(De,{size:14,color:"#00A76F"});case"down":return e.jsx(ze,{size:14,color:"#FF5630"});case"stable":return e.jsx(Te,{size:14,color:"#637381"});default:return null}},C=()=>{switch(b){case"up":return"#00A76F";case"down":return"#FF5630";case"stable":return"#637381";default:return"#637381"}};return e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(de,{label:`${l}%`,size:"small",color:l>=80?"success":l>=60?"warning":"error"}),y!==0&&e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:.25},children:[j(),e.jsxs(o,{variant:"caption",sx:{fontSize:"0.75rem",color:C(),fontWeight:500},children:[Math.abs(y),"%"]})]})]})};function en(){const l=re(),[b,y]=i.useState(2),[j,C]=i.useState("standards"),[D,W]=i.useState("excluded"),[N,U]=i.useState(1),[S]=i.useState(25),[A,B]=i.useState(null),[I,R]=i.useState(null),[F,$]=i.useState(""),[x,Q]=i.useState(""),[g,P]=i.useState("asc"),u=[{key:"listingName",label:"Listing Name",sortable:!0,mandatory:!0},{key:"nightsAvailable",label:"Nights Available",sortable:!0},{key:"nightsBooked",label:"Nights Booked",sortable:!0},{key:"ownerStayNights",label:"Owner Stay Nights",sortable:!0},{key:"occupancyRate",label:"Occupancy Rate",sortable:!0,mandatory:!0},{key:"totalCheckin",label:"Total Check-in",sortable:!0}],[m,X]=i.useState(["listingName","nightsAvailable","nightsBooked","ownerStayNights","occupancyRate","totalCheckin"]),Y=(n,t)=>{y(t),t===0&&l.push("/financial-reportings/analytics"),t===1&&l.push("/financial-reportings/rental-activity"),t===3&&l.push("/financial-reportings/quickbooks")},_=n=>{B(n.currentTarget)},f=()=>{B(null)},G=n=>{l.push(`/listings/${n}/edit`)},J=n=>{R(n.currentTarget)},Z=()=>{R(null)},K=n=>{const t=u.find(a=>a.key===n);t!=null&&t.mandatory||X(a=>a.includes(n)?a.filter(c=>c!==n):[...a,n])},ee=n=>{x===n?P(g==="asc"?"desc":"asc"):(Q(n),P("asc"))},ne=Math.ceil(z.length/S),M=(N-1)*S,te=M+S,ae=[...z].sort((n,t)=>{if(!x)return 0;const a=n[x],c=t[x];if(typeof a=="number"&&typeof c=="number")return g==="asc"?a-c:c-a;const L=String(a||""),O=String(c||"");return g==="asc"?L.localeCompare(O):O.localeCompare(L)}).slice(M,te),se=u.filter(n=>n.label.toLowerCase().includes(F.toLowerCase())),h=z.reduce((n,t)=>({nightsAvailable:n.nightsAvailable+t.nightsAvailable,nightsBooked:n.nightsBooked+t.nightsBooked,ownerStayNights:n.ownerStayNights+t.ownerStayNights,totalCheckin:n.totalCheckin+t.totalCheckin,occupancyChange:n.occupancyChange+t.occupancyChange}),{nightsAvailable:0,nightsBooked:0,ownerStayNights:0,totalCheckin:0,occupancyChange:0}),ie=h.nightsAvailable>0?(h.nightsBooked/h.nightsAvailable*100).toFixed(1):"0",oe=h.occupancyChange>0?"up":h.occupancyChange<0?"down":"stable";return e.jsxs(he,{maxWidth:"xl",children:[e.jsx(s,{sx:{mb:3},children:e.jsxs(xe,{value:b,onChange:Y,sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{textTransform:"none",fontWeight:500},"& .Mui-selected":{color:"primary.main",fontWeight:600},"& .MuiTabs-indicator":{bgcolor:"primary.main"}},children:[e.jsx(k,{label:"Analytics"}),e.jsx(k,{label:"Rental Activity"}),e.jsx(k,{label:"Occupancy Report"}),e.jsx(k,{label:"QuickBooks"})]})}),e.jsx(s,{sx:{mb:3},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(o,{variant:"h4",sx:{fontWeight:600},children:"Occupancy Report"}),e.jsxs(s,{sx:{display:"flex",gap:1},children:[e.jsx(d,{variant:"contained",children:"New Custom View"}),e.jsx(d,{variant:"outlined",onClick:_,endIcon:e.jsx(pe,{size:16}),children:"Download Report"}),e.jsxs(ge,{anchorEl:A,open:!!A,onClose:f,children:[e.jsx(r,{onClick:f,children:"Export CSV"}),e.jsx(r,{onClick:f,children:"Export Excel"}),e.jsx(r,{onClick:f,children:"Export PDF"})]})]})]})}),e.jsxs(w,{sx:{p:2,mb:3},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:2,mb:2,flexWrap:"wrap"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(d,{variant:j==="standards"?"contained":"outlined",size:"small",onClick:()=>C("standards"),children:"Standards"}),e.jsx(d,{variant:j==="by-month"?"contained":"outlined",size:"small",onClick:()=>C("by-month"),children:"By Month"})]}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(d,{variant:D==="excluded"?"contained":"outlined",size:"small",onClick:()=>W("excluded"),children:"Excluded Blocked Dates"}),e.jsx(d,{variant:D==="included"?"contained":"outlined",size:"small",onClick:()=>W("included"),children:"Included Blocked Dates"})]})]}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(v,{size:"small",type:"date",label:"From",InputLabelProps:{shrink:!0},sx:{minWidth:120}}),e.jsx(v,{size:"small",type:"date",label:"To",InputLabelProps:{shrink:!0},sx:{minWidth:120}}),e.jsx(d,{variant:"outlined",size:"small",children:"MTD"}),e.jsx(v,{size:"small",placeholder:"Check-in",sx:{minWidth:120}}),e.jsxs(E,{size:"small",sx:{minWidth:120},children:[e.jsx(V,{children:"Status"}),e.jsxs(H,{label:"Status",children:[e.jsx(r,{value:"confirmed",children:"Confirmed"}),e.jsx(r,{value:"pending",children:"Pending"}),e.jsx(r,{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs(E,{size:"small",sx:{minWidth:120},children:[e.jsx(V,{children:"Status"}),e.jsxs(H,{label:"Status",children:[e.jsx(r,{value:"confirmed",children:"Confirmed"}),e.jsx(r,{value:"pending",children:"Pending"}),e.jsx(r,{value:"cancelled",children:"Cancelled"})]})]}),e.jsx(d,{variant:"outlined",size:"small",children:"Reset Filter"})]})]}),e.jsx(w,{sx:{mb:3},children:e.jsx(ue,{sx:{maxHeight:600,overflowX:"auto",overflowY:"auto"},children:e.jsxs(me,{sx:{minWidth:m.length*150},children:[e.jsx(be,{children:e.jsxs(T,{children:[m.map(n=>{const t=u.find(a=>a.key===n);return t?e.jsx(p,{align:"center",sx:{fontWeight:600,minWidth:150,whiteSpace:"nowrap",cursor:t.sortable?"pointer":"default","&:hover":t.sortable?{bgcolor:"grey.50"}:{}},onClick:()=>t.sortable&&ee(n),children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:.5},children:[e.jsx(o,{variant:"subtitle2",sx:{fontWeight:600},children:t.label}),t.sortable&&e.jsxs(s,{sx:{display:"flex",flexDirection:"column",ml:.5},children:[e.jsx(je,{size:12,color:x===n&&g==="asc"?"#00A76F":"#637381"}),e.jsx(Ce,{size:12,color:x===n&&g==="desc"?"#00A76F":"#637381"})]})]})},n):null}),e.jsx(p,{align:"center",sx:{minWidth:60,width:60,position:"sticky",right:0,bgcolor:"background.paper",borderLeft:"1px solid",borderColor:"divider",zIndex:1,px:0},children:e.jsx(le,{onClick:J,size:"small",sx:{color:"text.secondary","&:hover":{bgcolor:"grey.100",color:"text.primary"}},children:e.jsx(fe,{size:16})})})]})}),e.jsxs(ye,{children:[ae.map(n=>e.jsxs(T,{children:[m.map(t=>u.find(c=>c.key===t)?e.jsx(p,{align:"center",sx:{minWidth:150,whiteSpace:"nowrap"},children:t==="listingName"?e.jsx(o,{variant:"body2",sx:{fontWeight:500,cursor:"pointer",color:"primary.main","&:hover":{textDecoration:"underline"}},onClick:()=>G(n.id),children:n.listingName}):t==="occupancyRate"?q(n.occupancyRate,n.occupancyTrend,n.occupancyChange):e.jsx(o,{variant:"body2",sx:{fontWeight:t==="ownerStayNights"?400:500},children:n[t]})},t):null),e.jsx(p,{align:"center",sx:{minWidth:60,width:60,position:"sticky",right:0,bgcolor:"background.paper",borderLeft:"1px solid",borderColor:"divider",zIndex:1,px:0}})]},n.id)),e.jsxs(T,{sx:{bgcolor:"grey.50",fontWeight:600},children:[m.map(n=>u.find(a=>a.key===n)?e.jsx(p,{align:"center",sx:{minWidth:150,whiteSpace:"nowrap"},children:n==="listingName"?e.jsx(o,{variant:"body2",sx:{fontWeight:600},children:"Total"}):n==="occupancyRate"?q(parseFloat(ie),oe,h.occupancyChange):e.jsx(o,{variant:"body2",sx:{fontWeight:600},children:h[n]})},n):null),e.jsx(p,{align:"center",sx:{minWidth:60,width:60,position:"sticky",right:0,bgcolor:"grey.50",borderLeft:"1px solid",borderColor:"divider",zIndex:1,px:0}})]})]})]})})}),e.jsx(w,{sx:{p:2},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Show 25 per page"}),e.jsx(ke,{count:ne,page:N,onChange:(n,t)=>U(t),color:"primary"})]})}),e.jsx(ce,{open:!!I,anchorEl:I,onClose:Z,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:300,maxHeight:400,p:2}},children:e.jsxs(s,{children:[e.jsx(o,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Column Settings"}),e.jsx(v,{size:"small",placeholder:"Find column",value:F,onChange:n=>$(n.target.value),InputProps:{startAdornment:e.jsx(ve,{size:16,color:"#666",style:{marginRight:8}})},sx:{mb:2}}),e.jsx(s,{sx:{display:"flex",flexDirection:"column",gap:1},children:se.map(n=>e.jsx(Se,{control:e.jsx(we,{checked:m.includes(n.key),onChange:()=>K(n.key),disabled:n.mandatory,size:"small",sx:{color:"primary.main","&.Mui-checked":{color:"primary.main"},"&.Mui-disabled":{color:"grey.400"}}}),label:e.jsxs(o,{variant:"body2",sx:{fontSize:"0.875rem",color:n.mandatory?"grey.500":"text.primary",fontWeight:n.mandatory?500:400},children:[n.label,n.mandatory&&" (Required)"]}),sx:{margin:0}},n.key))})]})})]})}export{en as OccupancyReportView};
